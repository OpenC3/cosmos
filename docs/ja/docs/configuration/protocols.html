<!doctype html><html lang=ja dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-configuration/protocols" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.7.0"><title data-rh=true>プロトコル | OpenC3 Docs</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://docs.openc3.com/ja/docs/configuration/protocols><meta data-rh=true property=og:locale content=ja><meta data-rh=true property=og:locale:alternate content=en><meta data-rh=true name=docusaurus_locale content=ja><meta data-rh=true name=docsearch:language content=ja><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="プロトコル | OpenC3 Docs"><meta data-rh=true name=description content=作成方法を含むCOSMOS組み込みプロトコル><meta data-rh=true property=og:description content=作成方法を含むCOSMOS組み込みプロトコル><link data-rh=true rel=icon href=/ja/img/favicon.png><link data-rh=true rel=canonical href=https://docs.openc3.com/ja/docs/configuration/protocols><link data-rh=true rel=alternate href=https://docs.openc3.com/docs/configuration/protocols hreflang=en><link data-rh=true rel=alternate href=https://docs.openc3.com/ja/docs/configuration/protocols hreflang=ja><link data-rh=true rel=alternate href=https://docs.openc3.com/docs/configuration/protocols hreflang=x-default><link rel=stylesheet href=/ja/assets/css/styles.14dc8b06.css><script src=/ja/assets/js/runtime~main.3296c500.js defer></script><script src=/ja/assets/js/main.6fe1c14d.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"dark",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/ja/img/logo.svg><div role=region aria-label=メインコンテンツまでスキップ><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>メインコンテンツまでスキップ</a></div><nav aria-label=ナビゲーション class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><button aria-label=ナビゲーションバーを開く aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/ja/><div class=navbar__logo><img src=/ja/img/logo.svg alt="OpenC3 ロゴ" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/ja/img/logo.svg alt="OpenC3 ロゴ" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">OpenC3 ドキュメント</b></a><a href=https://openc3.com target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">ホーム</a><a href=https://openc3.com/enterprise/ target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">Enterprise</a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/ja/docs>ドキュメント</a><a href=https://openc3.com/news/ target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">ニュース</a><a href=https://openc3.com/contact/ target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">お問い合わせ</a><a href=https://openc3.com/about/ target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">会社概要</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>日本語</a><ul class=dropdown__menu><li><a href=/docs/configuration/protocols target=_self rel="noopener noreferrer" class=dropdown__link lang=en>English</a><li><a href=/ja/docs/configuration/protocols target=_self rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=ja>日本語</a></ul></div><a href=https://github.com/OpenC3/cosmos target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title=ダークモードを切り替える(現在はダークモード) aria-label=ダークモードを切り替える(現在はダークモード) aria-live=polite aria-pressed=true><svg viewBox="0 0 24 24" width=24 height=24 class=lightToggleIcon_pyhR><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 class=darkToggleIcon_wfgR><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg></button></div><div class=navbarSearchContainer_Bca1><div class=navbar__search><span aria-label="expand searchbar" role=button class=search-icon tabindex=0></span><input id=search_input_react type=search placeholder=Loading... aria-label=Search class="navbar__search-input search-bar" disabled></div></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label=先頭へ戻る class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label=ドキュメントのサイドバー class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/ja/docs>紹介</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/docs/getting-started>はじめに</a><button aria-label="'はじめに'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/ja/docs/configuration>設定</a><button aria-label="'設定'の目次を隠す" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ja/docs/configuration/format>ファイル形式</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ja/docs/configuration/plugins>プラグイン</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ja/docs/configuration/target>ターゲット</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ja/docs/configuration/command>コマンド</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ja/docs/configuration/telemetry>テレメトリ</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ja/docs/configuration/interfaces>インターフェース</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/ja/docs/configuration/protocols>プロトコル</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ja/docs/configuration/accessors>アクセサー</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ja/docs/configuration/table>テーブル</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ja/docs/configuration/telemetry-screens>スクリーン</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ja/docs/configuration/ssl-tls>SSL-TLS</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/docs/tools>ツール</a><button aria-label="'ツール'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/docs/guides>ガイド</a><button aria-label="'ガイド'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/docs/development>開発</a><button aria-label="'開発'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/docs/meta>メタ情報</a><button aria-label="'メタ情報'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/ja/docs/privacy>OpenC3, Inc. Privacy Policy</a></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=パンくずリストのナビゲーション><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label=ホームページ class=breadcrumbs__link href=/ja/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/ja/docs/configuration><span itemprop=name>設定</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>プロトコル</span><meta itemprop=position content=2></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">このページの見出し</button></div><div class="theme-doc-markdown markdown"><header><h1>プロトコル</h1></header><p>プロトコルは<a href=/ja/docs/configuration/interfaces>インターフェース</a>の代わりにデータを処理します。書き込まれるデータ、読み取られるデータ、またはその両方を変更することができます。プロトコルはパケットをリアルタイムではなく保存済みとしてマークすることもでき、これによりCOSMOSはパケットデータで現在の値テーブルを更新しません。プロトコルは階層化することができ、順序通りに処理されます。例えば、より高レベルのバッファ長プロトコルを処理する前に最初に削除する必要がある低レベルの暗号化層がある場合などです。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg></span>プロトコル実行順序</div><div class=admonitionContent_BuS1><p>読み取りプロトコルは指定された順序で実行されます（最初に指定されたものが最初に実行されます）。書き込みプロトコルは逆順で実行されます（最後に指定されたものが最初に実行されます）。</div></div>
<p>プロトコルは一般的に、パケットを区切るロジックを定義し、インターフェースとの間でデータの読み書きを操作するために使用されます。COSMOSには、TCP/IPクライアント、TCP/IPサーバー、UDPクライアント/サーバー、およびシリアル接続のインターフェースが含まれています。ユースケースの99％では、これらのインターフェースはこれらの種類の接続からの読み書きの低レベルの詳細を普遍的に処理するため、変更を必要としません。すべての独自の動作は、現在プロトコルで定義する必要があります。</p>
<p>最低限、バイトストリームベースのインターフェースにはパケットを区切るためのプロトコルが必要です。TCP/IPとシリアルは、バイトストリームベースのインターフェースの例です。バイトストリームは単純なバイトのストリームであり、そのためストリーム内のパケットの開始と終了を知る方法が必要です。</p>
<p>TCP/IPはフレンドリーなバイトストリームです。非常に貧弱に書かれたシステムを扱っていない限り、TCP/IP接続で受信された最初のバイトは常にパケットの開始になります。また、TCP/IPは信頼性の高い接続であり、すべてのデータが正しい順序で受信され、データが失われず、データが破損しないことを保証します（TCP/IPはCRC32で保護されており、認識されないデータ破損を避けるのに非常に効果的です）。</p>
<p>シリアルは、はるかに扱いにくいバイトストリームです。シリアル接続では、シリアルポートを開いてデータの受信を開始すると、メッセージの途中から受信する可能性が非常に高いです（この問題は、コマンドに応答してのみシリアルポートに書き込むシステムとインターフェースする場合にのみ回避されます）。このため、同期パターンはシリアルインターフェースに非常に有益です。さらに、シリアルインターフェースは、認識されないデータ破損から保護するためにいくつかの方法（チェックサム、CRCなど）を使用することがあります。</p>
<p>UDPは本質的にパケットベースの接続です。UDPソケットから読み取ると、常に完全なパケットが返されます。最良のUDPベースのプロトコルはこの事実を活用しています。一部の実装ではUDPをバイトストリームのように動作させようとしますが、これはプロトコルの誤用であり、データを失う可能性が非常に高く、回復する方法がありません。</p>
<p>プロトコルがインターフェースとアクセサーにどのように適合するかについての詳細情報は、<a href=https://www.openc3.com/news/interoperability-without-standards target=_blank rel="noopener noreferrer">標準なしの相互運用性</a>を参照してください。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=パケット区切りプロトコル>パケット区切りプロトコル<a href=#パケット区切りプロトコル class=hash-link aria-label="パケット区切りプロトコル への直接リンク" title="パケット区切りプロトコル への直接リンク">​</a></h2>
<p>COSMOSは以下のパケット区切りプロトコルを提供しています：COBS、SLIP、Burst、Fixed、Length、Template（非推奨）、TerminatedおよびPreidentified。これらの各プロトコルの主な目的は、バイトストリームからパケットを分離することです。</p>
<p>COSMOS Enterpriseは以下のパケット区切りプロトコルを提供しています：CCSDS CLTU（BCHエンコード付き）、CCSDS TCTF（ランダマイザー付き）、CCSDS TMTF（ランダマイザー付き）、およびGEMS。</p>
<p>すべてのプロトコルは「Allow Empty Data」と呼ばれる最終パラメータを取ることに注意してください。これは、プロトコルが空の文字列を後続のプロトコルに渡すことを許可するかどうかを示します（<!-- -->:STOP<!-- -->を返す代わりに）。true、false、またはnilが可能で、nilはプロトコルがチェーンの最後のプロトコルでない限りtrueとして解釈されます。プロトコルのエンドユーザーはほとんどの場合、このパラメータを省略します。詳細については、<a href=/ja/docs/configuration/protocols#custom-protocol>カスタムプロトコル</a>のドキュメントを参照してください。</p>
<p>PROTOCOLキーワードの後の最初のパラメータは、プロトコルの適用方法を示します：READ、WRITE、またはREAD_WRITE。Readは入力パケット（テレメトリ）にプロトコルを適用し、writeは出力パケット（コマンド）に適用します。次のパラメータはプロトコルのファイル名またはクラス名です。その他のパラメータはプロトコル固有のものです。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=cobsプロトコル>COBSプロトコル<a href=#cobsプロトコル class=hash-link aria-label="COBSプロトコル への直接リンク" title="COBSプロトコル への直接リンク">​</a></h3>
<p>Consistent Overhead Byte Stuffing（COBS）プロトコルは、パケットの内容に関係なく、効率的で信頼性が高く、明確なパケットフレーミングを実現するデータバイトをエンコードするアルゴリズムです。これにより、受信アプリケーションが不正な形式のパケットから回復することが容易になります。パケットの区切り文字（パケット間の境界を示す特別な値）として機能するゼロバイト値を使用します。このアルゴリズムは、各ゼロデータバイトを非ゼロの値で置き換えるため、パケット内にゼロデータバイトが現れず、パケット境界として誤解釈されることがありません（詳細は <a href=https://en.wikipedia.org/wiki/Consistent_Overhead_Byte_Stuffing target=_blank rel="noopener noreferrer">https://en.wikipedia.org/wiki/Consistent_Overhead_Byte_Stuffing</a> を参照）。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=slipプロトコル>SLIPプロトコル<a href=#slipプロトコル class=hash-link aria-label="SLIPプロトコル への直接リンク" title="SLIPプロトコル への直接リンク">​</a></h3>
<p>Serial Line IP（SLIP）プロトコルは、シリアル回線上でIPパケットをフレーム化する文字シーケンスを定義します。ENDとESCという2つの特殊文字を定義します。ENDは0xC0で、ESCは0xDBです。パケットを送信するために、SLIPホストは単にパケット内のデータの送信を開始します。データバイトがEND文字と同じコードである場合、代わりにESCと0xDCの2バイトシーケンスが送信されます。データバイトがESC文字と同じである場合、代わりにESCと0xDDの2バイトシーケンスが送信されます。パケット内の最後のバイトが送信されると、END文字が送信されます（詳細は <a href=https://datatracker.ietf.org/doc/html/rfc1055 target=_blank rel="noopener noreferrer">https://datatracker.ietf.org/doc/html/rfc1055</a> を参照）。</p>
<table><thead><tr><th>パラメータ<th>説明<th>必須<th>デフォルト<tbody><tr><td>Start Char<td>フレームの先頭に配置する文字<td>いいえ<td>nil（文字なし）<tr><td>Read Strip Characters<td>読み取りからstart_charとend_charを削除する<td>いいえ<td>true<tr><td>Read Enable Escaping<td>読み取り時に文字エスケープを有効にするかどうか<td>いいえ<td>true<tr><td>Write Enable Escaping<td>書き込み時に文字エスケープを有効にするかどうか<td>いいえ<td>true<tr><td>End Char<td>フレームの末尾に配置する文字<td>いいえ<td>0xC0<tr><td>Esc Char<td>エスケープ文字<td>いいえ<td>0xDB<tr><td>Escape End Char<td>End文字をエスケープするための文字<td>いいえ<td>0xDC<tr><td>Escape Esc Char<td>Esc文字をエスケープするための文字<td>いいえ<td>0xDD</table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=バーストプロトコル>バーストプロトコル<a href=#バーストプロトコル class=hash-link aria-label="バーストプロトコル への直接リンク" title="バーストプロトコル への直接リンク">​</a></h3>
<p>バーストプロトコルは、データをCOSMOSパケットとして返す前に、インターフェースからできるだけ多くのデータを読み取ります（読み取られたデータの各バーストに対してパケットを返します）。このプロトコルは時間で区切られた定期的なデータバーストに依存しているため、非常に堅牢ではありません。ただし、必要に応じて再同期を可能にする同期パターンを利用できます。また、同期パターンを削除するために、受信データからバイトを破棄することもできます。最後に、インターフェースから書き出されるデータに同期パターンを追加することもできます。</p>
<table><thead><tr><th>パラメータ<th>説明<th>必須<th>デフォルト<tbody><tr><td>Discard Leading Bytes<td>読み取り後にバイナリデータから破棄するバイト数。同期パターンが使用されている場合、これは同期パターンから始まるバイトに適用されることに注意してください。<td>いいえ<td>0（バイトを破棄しない）<tr><td>Sync Pattern<td>生データ内で検索されるバイトパターンを表す16進文字列。このパターンはパケット区切り文字を表し、同期パターンを含むすべての検出データが返されます<td>いいえ<td>nil（同期パターンなし）<tr><td>Fill Fields<td>送信パケットに同期パターンを入力するかどうか<td>いいえ<td>false</table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=固定プロトコル>固定プロトコル<a href=#固定プロトコル class=hash-link aria-label="固定プロトコル への直接リンク" title="固定プロトコル への直接リンク">​</a></h3>
<p>固定プロトコルは、インターフェースを使用して定義されたすべてのパケットを適切に識別するために必要な、事前に設定された最小量のデータを読み取ります。その後、パケットを識別し、パケットを作成するために必要なだけのデータをインターフェースから読み取り、それを返します。このプロトコルは、インターフェース上のすべてのパケットが固定長であることに依存しています。例えば、インターフェースを使用するすべてのパケットは固定サイズであり、32ビットの同期パターンに続いて16ビットのIDを含む単純なヘッダーが含まれています。固定プロトコルは、最小読み取りサイズが6バイトであるこのケースをエレガントに処理します。固定プロトコルは、バーストプロトコルと同様に、同期パターン、先頭バイトの破棄、同期パターンの入力もサポートしています。</p>
<table><thead><tr><th>パラメータ<th>説明<th>必須<th>デフォルト<tbody><tr><td>Minimum ID Size<td>パケットを識別するために必要な最小バイト数。すべてのパケット定義は、この指定されたバイト数内でID_ITEMを宣言する必要があります。<td>はい<td><tr><td>Discard Leading Bytes<td>読み取り後にバイナリデータから破棄するバイト数。同期パターンが使用されている場合、これは同期パターンから始まるバイトに適用されることに注意してください。<td>いいえ<td>0（バイトを破棄しない）<tr><td>Sync Pattern<td>生データ内で検索されるバイトパターンを表す16進文字列。このパターンはパケット区切り文字を表し、同期パターンを含むすべての検出データが返されます。<td>いいえ<td>nil（同期パターンなし）<tr><td>Telemetry<td>データがテレメトリかどうか<td>いいえ<td>true（falseはコマンドを意味）<tr><td>Fill Fields<td>送信パケットに同期パターンを入力するかどうか<td>いいえ<td>false<tr><td>Unknown Raise<td>不明なパケットに対して例外を発生させるかどうか<td>いいえ<td>false</table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=長さプロトコル>長さプロトコル<a href=#長さプロトコル class=hash-link aria-label="長さプロトコル への直接リンク" title="長さプロトコル への直接リンク">​</a></h3>
<p>長さプロトコルは、インターフェースを使用する定義されたパケット内の固定位置にある長さフィールドに依存します。十分なデータを読み取って長さフィールドを取得し、それをデコードし、パケットの残りの長さを読み取ります。例えば、インターフェースを使用するすべてのパケットには、長さフィールドを持つCCSDSヘッダーが含まれています。長さプロトコルは、長さフィールドや、CCSDSが使用する長さオフセットも処理するように設定できます。長さプロトコルは、バーストプロトコルと同様に、同期パターン、先頭バイトの破棄、長さと同期パターンの入力もサポートしています。</p>
<table><thead><tr><th>パラメータ<th>説明<th>必須<th>デフォルト<tbody><tr><td>Length Bit Offset<td>パケットの先頭から長さフィールドまでのビットオフセット。このインターフェースを使用するすべてのパケットは、長さフィールドが同じ場所で同じサイズになるような同じ構造を持っている必要があります。この値に同期パターンの長さを考慮することを忘れないでください（存在する場合）。<td>いいえ<td>0ビット<tr><td>Length Bit Size<td>長さフィールドのビットサイズ<td>いいえ<td>16ビット<tr><td>Length Value Offset<td>長さフィールド値に適用するオフセット。長さフィールドの実際の値にこのオフセットを加えると、パケットのすべてのデータ（長さフィールド自体、同期パターンなどを含む）を読み取るために必要な正確なバイト数と等しくなる必要があります。例えば、長さフィールドがパケット長から1を引いた値を示す場合、この値は1になります。この値に同期パターンの長さを考慮することを忘れないでください（存在する場合）。<td>いいえ<td>0<tr><td>Bytes per Count<td>各長さフィールドの「カウント」あたりのバイト数。これは、長さフィールドの単位がバイト以外の場合（例えば、長さフィールドのカウントがワード単位の場合）に使用されます。<td>いいえ<td>1バイト<tr><td>Length Endianness<td>長さフィールドのエンディアン。「BIG_ENDIAN」または「LITTLE_ENDIAN」のいずれかでなければなりません。<td>いいえ<td>'BIG_ENDIAN'<tr><td>Discard Leading Bytes<td>読み取り後にバイナリデータから破棄するバイト数。同期パターンが使用されている場合、これは同期パターンを含むバイトに適用されることに注意してください。破棄は最後のステップの1つであるため、上記のサイズとオフセットは破棄前のすべてのデータを考慮する必要があります。<td>いいえ<td>0（バイトを破棄しない）<tr><td>Sync Pattern<td>生データ内で検索されるバイトパターンを表す16進文字列。このパターンはパケット区切り文字を表し、同期パターンを含むすべての検出データが返されます。<td>いいえ<td>nil（同期パターンなし）<tr><td>Max Length<td>長さフィールドで許可される最大値<td>いいえ<td>nil（最大長なし）<tr><td>Fill Length and Sync Pattern<td>このフラグをtrueに設定すると、送信パケットに長さフィールドと同期パターン（存在する場合）が自動的に入力されます。<td>いいえ<td>false</table>
<p>長さプロトコルの最も混乱する側面は、Length Value Offsetの計算です。これは、よく使用されるCCSDS宇宙パケットプロトコルで特に当てはまります。これを説明する最良の方法は例を使用することです。同期パターン0x1ACFFC1Dが前に付いたCCSDS宇宙パケットがあるとします。これは次のようになります：</p>
<table><thead><tr><th>同期（4バイト）<th>ヘッダー（4バイト）<th>長さ（2バイト）<th>データ（4バイト）<tbody><tr><td>0x1ACFFC1D<td>0x0001CADB<td>0x0003<td>0xDEADBEEF</table>
<p>この場合、パケットの合計長は14バイトです：<strong>4 + 4 + 2 + 4 = 14</strong>。データが4バイトの場合、CCSDSでは長さフィールドは（データ長 - 1）として計算されるため、長さフィールドは3になります。では、Length Value Offsetをどのように計算すればよいでしょうか？COSMOSはパケット内のすべてのバイト（同期パターンを含む）を読み取るため、合計長は14バイトです。長さフィールドは3なので、Length Value Offset（長さフィールド値に適用するオフセット）は11であるべきです（<strong>3 + 11 = 14</strong>）。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=終端プロトコル>終端プロトコル<a href=#終端プロトコル class=hash-link aria-label="終端プロトコル への直接リンク" title="終端プロトコル への直接リンク">​</a></h3>
<p>終端プロトコルは、各パケットの末尾にある終端文字を使用してパケットを区切ります。終端文字が見つかるまで継続的にデータを読み取り、その時点でパケットデータを返します。例えば、インターフェースを使用するすべてのパケットの後に0xABCDが続きます。このデータは、保持される各パケットの一部であるか、または終端プロトコルだけが知っていて単に捨てられるものであるかのいずれかです。</p>
<table><thead><tr><th>パラメータ<th>説明<th>必須<th>デフォルト<tbody><tr><td>Write Termination Characters<td>コマンドパケットを書き込んだ後に書き込むデータ。0xABCDなどの16進文字列として指定します。<td>はい<td><tr><td>Read Termination Characters<td>テレメトリパケットの終わりを示す文字。0xABCDなどの16進文字列として指定します。<td>はい<td><tr><td>Strip Read Termination<td>テレメトリパケットを返す前に読み取り終端文字を削除するかどうか<td>いいえ<td>true<tr><td>Discard Leading Bytes<td>読み取り後にバイナリデータから破棄するバイト数。同期パターンが使用されている場合、これは同期パターンを含むバイトに適用されることに注意してください。<td>いいえ<td>0（バイトを破棄しない）<tr><td>Sync Pattern<td>生データ内で検索されるバイトパターンを表す16進文字列。このパターンはパケット区切り文字を表し、同期パターンを含むすべての検出データが返されます。<td>いいえ<td>nil（同期パターンなし）<tr><td>Fill Fields<td>送信パケットに同期パターンを入力するかどうか<td>いいえ<td>false</table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=gemsプロトコルenterprise>GEMSプロトコル（Enterprise）<a href=#gemsプロトコルenterprise class=hash-link aria-label="GEMSプロトコル（Enterprise） への直接リンク" title="GEMSプロトコル（Enterprise） への直接リンク">​</a></h3>
<p>GEMSプロトコルは、地上機器監視サービスプロトコルを実装しています。これは、「|END」を使用してパケットを区切るTerminatedProtocolと一緒に追加されます。GEMSインターフェースは現在Rubyでのみ実装されています。</p>
<p>GEMSプロトコルはパラメータを取りませんが、TerminatedProtocolとCmdResponseProtocolの後にインターフェースに追加する必要があります。</p>
<p>plugin.txt Rubyの例：</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token constant" style="color:rgb(130, 170, 255)">INTERFACE</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">GEMS_INT</span><span class="token plain"> tcpip_client_interface</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">rb openc3</span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token plain">operator </span><span class="token number" style="color:rgb(247, 140, 108)">8080</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">8080</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10.0</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">nil</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">nil</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># TerminatedProtocol 0x7C454E44 0x7C454E44 false 0       0x7C47454D53 false ... の意味：</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#                    wtc        rtc        strip discard sync         fill</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># wtc = 書き込み終端文字、gemsプロトコルの終わり：0x7C454E44 == '|END'</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#       rtc = 読み取り終端文字、gemsプロトコルの終わり：0x7C454E44 == '|END'</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#       strip = 読み取り終端を削除（false）</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#       discard = 0バイト</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#       sync pattern = GEMSプロトコルの始まり：0x7C47454D53 == '|GEMS'</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#       fill = 同期パターンを入力するかどうか（cmd/tlm定義でfillを指定するのでfalse）</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token constant" style="color:rgb(130, 170, 255)">PROTOCOL</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">READ</span><span class="token plain"> TerminatedProtocol </span><span class="token number" style="color:rgb(247, 140, 108)">0x7C454E44</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x7C454E44</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x7C47454D53</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># CmdResponseProtocol 5.0 0.2 true の意味：</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#   5秒応答タイムアウト、0.2秒応答ポーリング、</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#   そしてプロトコルエラーが発生したときに例外を発生させるためのtrue</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token constant" style="color:rgb(130, 170, 255)">PROTOCOL</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">READ_WRITE</span><span class="token plain"> CmdResponseProtocol </span><span class="token number" style="color:rgb(247, 140, 108)">5.0</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.2</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token constant" style="color:rgb(130, 170, 255)">PROTOCOL</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">READ_WRITE</span><span class="token plain"> GemsProtocol</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>完全な例については、COSMOS Enterprise Pluginsの<a href=https://github.com/OpenC3/cosmos-enterprise-plugins/tree/main/openc3-cosmos-gems-interface target=_blank rel="noopener noreferrer">openc3-cosmos-gems-interface</a>を参照してください。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=ccsds-cltuプロトコルenterprise>CCSDS CLTUプロトコル（Enterprise）<a href=#ccsds-cltuプロトコルenterprise class=hash-link aria-label="CCSDS CLTUプロトコル（Enterprise） への直接リンク" title="CCSDS CLTUプロトコル（Enterprise） への直接リンク">​</a></h3>
<p>CCSDS CLTUプロトコルは、コマンドストリーム用のCLTU（通信リンク転送ユニット）を処理します。これは送信メッセージをBCHエンコーディングでエンコードし、データにヘッダーとフッターを適用します。</p>
<table><thead><tr><th>パラメータ<th>説明<th>必須<th>デフォルト<tbody><tr><td>Header<td>BCHエンコードデータの前のヘッダー<td>いいえ<td>0xEB90<tr><td>Footer<td>BCHエンコードデータの後のフッター<td>いいえ<td>0xC5C5C5C5C5C5C579<tr><td>Fill Byte<td>BCHエンコーディングのフィルバイト<td>いいえ<td>0x55</table>
<p>完全な例については、COSMOS Enterprise Pluginsの<a href=https://github.com/OpenC3/cosmos-enterprise-plugins/tree/main/openc3-cosmos-ccsds-protocols target=_blank rel="noopener noreferrer">openc3-cosmos-ccsds-protocols</a>を参照してください。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=ccsds-tctfプロトコルenterprise>CCSDS TCTFプロトコル（Enterprise）<a href=#ccsds-tctfプロトコルenterprise class=hash-link aria-label="CCSDS TCTFプロトコル（Enterprise） への直接リンク" title="CCSDS TCTFプロトコル（Enterprise） への直接リンク">​</a></h3>
<p>CCSDS TCTFプロトコルは、コマンドストリーム用のテレコマンド転送フレームを処理します。</p>
<table><thead><tr><th>パラメータ<th>説明<th>必須<th>デフォルト<tbody><tr><td>Randomization<td>転送フレームをエンコードし、ランダム化するかどうか<td>いいえ<td>true<tr><td>Error Control<td>フレームエラー制御フィールドを使用し、16ビットCRCを適用するかどうか<td>いいえ<td>false<tr><td>Bypass<td>バイパスビット（0はType-A、1はType-B（フレーム受け入れチェックをバイパス））<td>いいえ<td>1<tr><td>SCID<td>宇宙機識別子（10ビット）<td>いいえ<td>0<tr><td>VCID<td>仮想チャネル識別子（6ビット）<td>いいえ<td>0</table>
<p>完全な例については、COSMOS Enterprise Pluginsの<a href=https://github.com/OpenC3/cosmos-enterprise-plugins/tree/main/openc3-cosmos-ccsds-protocols target=_blank rel="noopener noreferrer">openc3-cosmos-ccsds-protocols</a>を参照してください。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=ccsds-tmtfプロトコルenterprise>CCSDS TMTFプロトコル（Enterprise）<a href=#ccsds-tmtfプロトコルenterprise class=hash-link aria-label="CCSDS TMTFプロトコル（Enterprise） への直接リンク" title="CCSDS TMTFプロトコル（Enterprise） への直接リンク">​</a></h3>
<p>CCSDS TMTFプロトコルは、テレメトリストリーム用のテレメトリ転送フレームを処理します。VCID、MC_FRM_CNT、VC_FRM_CNTをextraに追加し、これらはDecomデータに含まれます。</p>
<table><thead><tr><th>パラメータ<th>説明<th>必須<th>デフォルト<tbody><tr><td>SCID<td>宇宙機識別子（10ビット）<td>はい<td><tr><td>Frame Length<td>フレーム長<td>いいえ<td>2048<tr><td>Randomization<td>転送フレームがエンコードされ、ランダム化されたかどうか<td>いいえ<td>true<tr><td>Discard Leading Bytes<td>読み取り後にバイナリデータから破棄するバイト数。同期パターンが使用されている場合、これは同期パターンを含むバイトに適用されることに注意してください。<td>いいえ<td>0（バイトを破棄しない）<tr><td>Sync Pattern<td>生データ内で検索されるバイトパターンを表す16進文字列。このパターンはパケット区切り文字を表し、同期パターンを含むすべての検出データが返されます。<td>いいえ<td>0x1ACFFC1D<tr><td>Fill Fields<td>送信パケットに同期パターンを入力するかどうか<td>いいえ<td>true</table>
<p>完全な例については、COSMOS Enterprise Pluginsの<a href=https://github.com/OpenC3/cosmos-enterprise-plugins/tree/main/openc3-cosmos-ccsds-protocols target=_blank rel="noopener noreferrer">openc3-cosmos-ccsds-protocols</a>を参照してください。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=テンプレートプロトコル非推奨>テンプレートプロトコル（非推奨）<a href=#テンプレートプロトコル非推奨 class=hash-link aria-label="テンプレートプロトコル（非推奨） への直接リンク" title="テンプレートプロトコル（非推奨） への直接リンク">​</a></h3>
<p>このプロトコルは、COSMOS生ログにおいて元のSCPIメッセージをキャプチャできないため、現在は非推奨です。代わりにTemplateAccessorとCmdResponseProtocolを使用してください。</p>
<p>テンプレートプロトコルは、SCPI（プログラム可能な機器用標準コマンド）などのテキストベースのコマンドおよび応答タイプのインターフェース用に設計されている点を除いて、終端プロトコルと非常によく似ています。各パケットが行と呼ばれる（通常は各行にテキスト行が含まれるため）ことを除いて、終端プロトコルと同じ方法でパケットを区切ります。送信パケットの場合、パケット内にCMD_TEMPLATEフィールドが存在することが期待されます。このフィールドには、HTMLタグスタイルの括弧<code>"&lt;EXAMPLE>"</code>内で区切られた、埋め込むべき項目を含むテンプレート文字列が含まれています。テンプレートプロトコルはパケット内から名前付き項目を読み取り、CMD_TEMPLATEに入力します。このように入力された文字列は、元々渡されたパケットではなく送信されます。同様に、応答が期待される場合、送信パケットにはRSP_TEMPLATEおよびRSP_PACKETフィールドを含める必要があります。RSP_TEMPLATEは応答文字列からデータを抽出し、対応するRSP_PACKETを構築するために使用されます。使用例については、COSMOSデモ設定内のTEMPLATEターゲットを参照してください。</p>
<table><thead><tr><th>パラメータ<th>説明<th>必須<th>デフォルト<tbody><tr><td>Write Termination Characters<td>コマンドパケットを書き込んだ後に書き込むデータ。0xABCDなどの16進文字列として指定します。<td>はい<td><tr><td>Read Termination Characters<td>テレメトリパケットの終わりを示す文字。0xABCDなどの16進文字列として指定します。<td>はい<td><tr><td>Ignore Lines<td>無視する応答行の数（完全に削除）<td>いいえ<td>0行<tr><td>Initial Read Delay<td>接続後の初期遅延時間。この後、インターフェースは空になるまで読み取られ、データは破棄されます。接続ヘッダーと初期プロンプトを破棄するのに役立ちます。<td>いいえ<td>nil（初期読み取りなし）<tr><td>Response Lines<td>期待される応答を構成する行数<td>いいえ<td>1行<tr><td>Strip Read Termination<td>テレメトリパケットを返す前に読み取り終端文字を削除するかどうか<td>いいえ<td>true<tr><td>Discard Leading Bytes<td>読み取り後にバイナリデータから破棄するバイト数。同期パターンが使用されている場合、これは同期パターンを含むバイトに適用されることに注意してください。<td>いいえ<td>0（バイトを破棄しない）<tr><td>Sync Pattern<td>生データ内で検索されるバイトパターンを表す16進文字列。このパターンはパケット区切り文字を表し、同期パターンを含むすべての検出データが返されます。<td>いいえ<td>nil（同期パターンなし）<tr><td>Fill Fields<td>送信パケットに同期パターンを入力するかどうか<td>いいえ<td>false<tr><td>Response Timeout<td>応答がタイムアウトするまでの待機秒数<td>いいえ<td>5.0<tr><td>Response Polling Period<td>応答のポーリング間の待機秒数<td>いいえ<td>0.02<tr><td>Raise Exceptions<td>タイムアウトや予期しない応答などのエラーが発生した場合に例外を発生させるかどうか<td>いいえ<td>false</table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=事前識別プロトコル内部>事前識別プロトコル（内部）<a href=#事前識別プロトコル内部 class=hash-link aria-label="事前識別プロトコル（内部） への直接リンク" title="事前識別プロトコル（内部） への直接リンク">​</a></h3>
<p>事前識別プロトコルは、カスタムCOSMOSヘッダーを使用してパケットを区切ります。この内部プロトコルは、ツールが接続してパケットストリーム全体を受信できるようにするために作成されました。また、複数のCOSMOSインスタンスを連結するためにも使用できますが、新しいウェブネイティブ実装ではほとんど必要ありません。</p>
<table><thead><tr><th>パラメータ<th>説明<th>必須<th>デフォルト<tbody><tr><td>Sync Pattern<td>生データ内で検索されるバイトパターンを表す16進文字列。このパターンはパケット区切り文字を表し、同期パターンの後にあるすべてのデータが返されます。同期パターン自体は破棄されます。<td>いいえ<td>nil（同期パターンなし）<tr><td>Max Length<td>長さフィールドで許可される最大値<td>いいえ<td>nil（最大長なし）<tr><td>Mode<td>サポートする事前識別プロトコルのバージョン（2または4）<td>いいえ<td>4</table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=ヘルパープロトコル>ヘルパープロトコル<a href=#ヘルパープロトコル class=hash-link aria-label="ヘルパープロトコル への直接リンク" title="ヘルパープロトコル への直接リンク">​</a></h2>
<p>COSMOSは以下のヘルパープロトコルを提供しています：CmdResponse、Crc、およびIgnore。これらのプロトコルはインターフェースにヘルパー機能を提供します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=cmdresponseプロトコル>CmdResponseプロトコル<a href=#cmdresponseプロトコル class=hash-link aria-label="CmdResponseプロトコル への直接リンク" title="CmdResponseプロトコル への直接リンク">​</a></h3>
<p>CmdResponseプロトコルは、定義された応答パケットを持つコマンドの応答を待ちます。</p>
<table><thead><tr><th>パラメータ<th>説明<th>必須<th>デフォルト<tbody><tr><td>Response Timeout<td>応答を待つ際にタイムアウトするまでの秒数<td>いいえ<td>5<tr><td>Response Polling Period<td>応答のポーリング間の待機秒数<td>いいえ<td>0.02<tr><td>Raise Exceptions<td>予期しない応答や応答タイムアウトなどのプロトコルでエラーが発生した場合に例外を発生させるかどうか<td>いいえ<td>false</table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=パケット定義>パケット定義<a href=#パケット定義 class=hash-link aria-label="パケット定義 への直接リンク" title="パケット定義 への直接リンク">​</a></h4>
<p>CmdResponseProtocolは、コマンド定義内の<a href=/ja/docs/configuration/command#response>RESPONSE</a>キーワードを使用して、指定されたコマンドが送信されたときに期待されるテレメトリパケットを決定します。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token plain">COMMAND SCPI_PS GET_STATUS BIG_ENDIAN "Gets status"</span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  ACCESSOR TemplateAccessor</span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  TEMPLATE ":MEAS:VOLT? (@1:2)"</span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  RESPONSE SCPI_PS STATUS</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>応答パケット（STATUS）は、応答データを含むように定義する必要があります。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token plain">TELEMETRY SCPI_PS STATUS BIG_ENDIAN "Status"</span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  ACCESSOR TemplateAccessor</span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  TEMPLATE "&lt;MEAS_VOLTAGE_1>,&lt;MEAS_VOLTAGE_2>"</span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  APPEND_ITEM MEAS_VOLTAGE_1 32 FLOAT "Voltage Reading for Channel 1"</span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    UNITS VOLTS V</span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    FORMAT_STRING %0.3f</span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  APPEND_ITEM MEAS_VOLTAGE_2 32 FLOAT "Voltage Reading for Channel 2"</span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    UNITS VOLTS V</span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    FORMAT_STRING %0.3f</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>完全な例については、COSMOS Enterprise Pluginsの<a href=https://github.com/OpenC3/cosmos-enterprise-plugins/tree/main/openc3-cosmos-scpi-power-supply target=_blank rel="noopener noreferrer">openc3-cosmos-scpi-power-supply</a>を参照してください。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=crcプロトコル>CRCプロトコル<a href=#crcプロトコル class=hash-link aria-label="CRCプロトコル への直接リンク" title="CRCプロトコル への直接リンク">​</a></h3>
<p>CRCプロトコルは、送信コマンドにCRCを追加し、受信テレメトリパケットのCRCを検証できます。</p>
<table><thead><tr><th>パラメータ<th>説明<th>必須<th>デフォルト<tbody><tr><td>Write Item Name<td>送信パケットの計算済みCRC値で埋めるアイテム（nil = 埋めない）<td>いいえ<td>nil<tr><td>Strip CRC<td>受信パケットからCRCを削除するかどうか<td>いいえ<td>false<tr><td>Bad Strategy<td>受信パケットのCRCエラーを処理する方法。ERROR = エラーのみをログに記録、DISCONNECT = インターフェースを切断<td>いいえ<td>"ERROR"<tr><td>Bit Offset<td>データ内のCRCのビットオフセット。負の値はパケットの末尾からの距離を示します<td>いいえ<td>-32<tr><td>Bit Size<td>CRCのビットサイズ - 16、32、または64でなければなりません<td>いいえ<td>32<tr><td>Endianness<td>CRCのエンディアン（BIG_ENDIAN/LITTLE_ENDIAN）<td>いいえ<td>"BIG_ENDIAN"<tr><td>Poly<td>CRCを計算する際に使用する多項式（整数として表現）<td>いいえ<td>nil（デフォルトの多項式を使用 - 16ビット=0x1021、32ビット=0x04C11DB7、64ビット=0x42F0E1EBA9EA3693）<tr><td>Seed<td>計算を開始するシード値<td>いいえ<td>nil（デフォルトのシードを使用 - 16ビット=0xFFFF、32ビット=0xFFFFFFFF、64ビット=0xFFFFFFFFFFFFFFFF）<tr><td>Xor<td>CRC結果を0xFFFFとXOR演算するかどうか<td>いいえ<td>nil（デフォルト値を使用 - 16ビット=false、32ビット=true、64ビット=true）<tr><td>Reflect<td>CRCを計算する前にデータの各バイトのビットを反転するかどうか<td>いいえ<td>nil（デフォルト値を使用 - 16ビット=false、32ビット=true、64ビット=true）</table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=パケット無視プロトコル>パケット無視プロトコル<a href=#パケット無視プロトコル class=hash-link aria-label="パケット無視プロトコル への直接リンク" title="パケット無視プロトコル への直接リンク">​</a></h3>
<p>パケット無視プロトコルは、COSMOSによって送信された特定のコマンドパケットまたは受信テレメトリパケットを破棄します。</p>
<table><thead><tr><th>パラメータ<th>説明<th>必須<th>デフォルト<tbody><tr><td>Target Name<td>無視するパケットのターゲット名<td>はい<td>nil<tr><td>Packet Name<td>無視するパケットのパケット名<td>はい<td>nil</table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=custom-protocol>カスタムプロトコル<a href=#custom-protocol class=hash-link aria-label="カスタムプロトコル への直接リンク" title="カスタムプロトコル への直接リンク">​</a></h2>
<p>カスタムプロトコルの作成は簡単で、COSMOSインターフェースをカスタマイズするためのデフォルトの解決策であるべきです（新しいインターフェースクラスを作成するのではなく）。ただし、カスタムインターフェースを作成することは、ターゲットに対して常に固定されている値にパラメータをデフォルト設定し、必要なプロトコルを含めるのにも役立ちます。基本COSMOSインターフェースは多くのパラメータを取り、エンドユーザーにとって混乱する可能性があります。したがって、これらの値をハードコードし、利用可能なパラメータをホスト名や接続ポートなどに絞り込むためだけにカスタムインターフェースを作成することをお勧めします。</p>
<p>すべてのカスタムプロトコルは、Protocolクラス<a href=https://github.com/OpenC3/cosmos/blob/main/openc3/lib/openc3/interfaces/protocols/protocol.rb target=_blank rel="noopener noreferrer">openc3/interfaces/protocols/protocol.rb</a>（Ruby）および<a href=https://github.com/OpenC3/cosmos/blob/main/openc3/python/openc3/interfaces/protocols/protocol.py target=_blank rel="noopener noreferrer">openc3/interfaces/protocols/protocol.py</a>（Python）から派生する必要があります。このクラスは、独自のプロトコルを作成するための9つのメソッドを定義しています。各メソッドの基本クラス実装と、それらのメソッドを独自のプロトコルでどのようにオーバーライドして使用するかについての説明が以下に含まれています。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg></span>Ruby プロトコルAPI</div><div class=admonitionContent_BuS1><p>プロトコルはCOSMOSインターフェースの一部であるため、<code>require 'openc3/script'</code>を使用すべきではありません。代わりに、<a href=https://github.com/OpenC3/cosmos/blob/main/openc3/lib/openc3/system/system.rb target=_blank rel="noopener noreferrer">System</a>、<a href=https://github.com/OpenC3/cosmos/blob/main/openc3/lib/openc3/packets/packet.rb target=_blank rel="noopener noreferrer">Packet</a>、<a href=https://github.com/OpenC3/cosmos/blob/main/openc3/lib/openc3/utilities/bucket.rb target=_blank rel="noopener noreferrer">Bucket</a>、<a href=https://github.com/OpenC3/cosmos/blob/main/openc3/lib/openc3/accessors/binary_accessor.rb target=_blank rel="noopener noreferrer">BinaryAccessor</a>などのCOSMOSライブラリコードを直接使用する必要があります。不明な点がある場合は、既存のCOSMOSの<a href=https://github.com/OpenC3/cosmos/tree/main/openc3/lib/openc3/interfaces/protocols target=_blank rel="noopener noreferrer">プロトコル</a>クラスを参照してください。</div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg></span>Python プロトコルAPI</div><div class=admonitionContent_BuS1><p>プロトコルはCOSMOSインターフェースの一部であるため、<code>from openc3.script import *</code>を使用すべきではありません。代わりに、<a href=https://github.com/OpenC3/cosmos/blob/main/openc3/python/openc3/system/system.py target=_blank rel="noopener noreferrer">System</a>、<a href=https://github.com/OpenC3/cosmos/blob/main/openc3/python/openc3/packets/packet.py target=_blank rel="noopener noreferrer">Packet</a>、<a href=https://github.com/OpenC3/cosmos/blob/main/openc3/python/openc3/utilities/bucket.py target=_blank rel="noopener noreferrer">Bucket</a>、<a href=https://github.com/OpenC3/cosmos/blob/main/openc3/python/openc3/accessors/binary_accessor.py target=_blank rel="noopener noreferrer">BinaryAccessor</a>などのCOSMOSライブラリコードを直接使用する必要があります。不明な点がある場合は、既存のCOSMOSの<a href=https://github.com/OpenC3/cosmos/tree/main/openc3/python/openc3/interfaces/protocols target=_blank rel="noopener noreferrer">プロトコル</a>クラスを参照してください。</div></div>
<p>プロトコルがどのように機能するかを本当に理解するためには、まず基本インターフェースクラスの読み取りと書き込みのメソッド内のロジックを理解する必要があります。</p>
<p>まず、readメソッドについて説明しましょう。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg></span>Rubyのシンボル、Pythonの文字列</div><div class=admonitionContent_BuS1><p>以下の説明では、大文字の単語はRubyではシンボル、Pythonでは文字列を表します。したがって、STOPへの参照はRubyでは<!-- -->:STOP<!-- -->、Pythonでは"STOP"を意味します。</div></div>
<p><img decoding=async loading=lazy alt="Interface Read Logic" src=/ja/assets/images/interface_read_logic-0deef27c1d2fec9de2a3720a3c9ecedb21a00dca7aabd13da0b8815c037e4c26.png width=1063 height=542 class=img_ev3q></p>
<p>readが_毎回_呼び出されるたびに、空の文字列""が最初に、インターフェースの<code>read_interface()</code>メソッドを使用して新しい生データの読み取りが試みられる_前に_、各読み取りプロトコルの<code>read_data()</code>メソッドに渡されます。これは、複数のパケット分のデータをキャッシュしているプロトコルに対して、インターフェースから新しいデータが読み取られる前にそれらのキャッシュされたパケットを出力するよう指示する信号です。通常、データはキャッシュされず、プロトコルの<code>read_data()</code>メソッドの1つが空の文字列に応答してSTOPを返し、パケットを生成するためにはさらにデータが必要であることを示します。各プロトコルの<code>read_data()</code>メソッドは、次の3つのいずれかを返すことができます：追加のプロトコルに渡されるか、パケットに変換されるデータ、プロトコルを続行するためにインターフェースからさらにデータが必要であることを意味するSTOP、またはインターフェースの切断（およびデフォルトでは再接続を試みる）が必要な何かが起こったことを意味するDISCONNECT。各プロトコルの<code>read_data()</code>メソッドには、最終的にパケットに変換されるデータが渡され、おそらく修正されたデータのセットが返されます。データがすべてのプロトコルの<code>read_data()</code>メソッドを通過すると、インターフェースのconvert_data_to_packet()メソッドを使用してCOSMOSパケットに変換されます。このパケットは同様の方法で各読み取りプロトコルのread_packet()メソッドを通過します。このメソッドは基本的に同じ戻り値の可能性を持っています：パケット（<code>read_data()</code>のデータではなく）、STOP、またはDISCONNECT。パケットがすべてのread_packet()メソッドを通過すると、インターフェースのパケット読み取りカウンターがインクリメントされ、パケットがインターフェースに返されます。</p>
<p><img decoding=async loading=lazy alt="Interface Write Logic" src=/ja/assets/images/interface_write_logic-3360afe1b4af20b10dafba848a21e09baccaacc06e2ec8b6c132ac7a3c99e994.png width=931 height=944 class=img_ev3q></p>
<p>インターフェースのwrite()メソッドは、readと非常に似た働きをします。（デフォルトでは、書き込みプロトコルは読み取りプロトコルの逆順で実行されることに注意してください。これは、読み取り時にはデータの層を取り除き、書き込み時には逆順で層を追加するのが一般的なため理にかなっています。）</p>
<p>まず、パケット書き込みカウンターがインクリメントされます。次に、各書き込みプロトコルは、そのwrite_packet()メソッドが呼び出されることによってパケットを変更する機会が与えられます。このメソッドは、潜在的に修正されたパケット、STOP、またはDISCONNECTのいずれかを返すことができます。書き込みプロトコルがSTOPを返す場合、データはインターフェースに書き込まれず、最終的なパケットを出力する前にさらにパケットが必要であると想定されます。DISCONNECTはインターフェースを切断します。パケットがすべての書き込みプロトコルのwrite_packet()メソッドを通過すると、インターフェースのconvert_packet_to_data()メソッドを使用してバイナリデータに変換されます。次に、各書き込みプロトコルのwrite_data()メソッドが呼び出され、低レベルのデータを変更する機会が与えられます。COSMOSパケットではなくRuby文字列のデータが返される点を除いて、同じ戻りオプションが利用可能です。データがすべてのwrite_data()メソッドを通過すると、write_interface()メソッドを使用してインターフェースに書き込まれます。その後、各プロトコルのpost_write_interface()メソッドが、最終的に変更されたパケットと、インターフェースに実際に書き込まれたデータの両方で呼び出されます。このメソッドは、メッセージを書き出した後の応答を待つなどのフォローアップを可能にします。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=メソッドの説明>メソッドの説明<a href=#メソッドの説明 class=hash-link aria-label="メソッドの説明 への直接リンク" title="メソッドの説明 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=initialize-または-init>initialize または <strong>init</strong><a href=#initialize-または-init class=hash-link aria-label="initialize-または-init への直接リンク" title="initialize-または-init への直接リンク">​</a></h3>
<p>これはカスタムプロトコルのコンストラクタです。基本プロトコルクラスを初期化するために、常にsuper(allow_empty_data)を呼び出す必要があります。</p>
<p>基本クラスのRuby実装:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># @param allow_empty_data [true/false] 空データでSTOPを返すべきかどうか</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(130, 170, 255)">initialize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">allow_empty_data </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token variable" style="color:rgb(214, 222, 235)">@interface</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">nil</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token variable" style="color:rgb(214, 222, 235)">@allow_empty_data</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> ConfigParser</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">handle_true_false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">allow_empty_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  reset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">end</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>基本クラスのPython実装:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">__init__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> allow_empty_data</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">interface </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">allow_empty_data </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> ConfigParser</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">handle_true_false_none</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">allow_empty_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">reset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>ご覧のように、すべてのプロトコルは少なくとも2つの項目に関して状態を維持しています。interface変数は、プロトコルが関連付けられているインターフェースクラスのインスタンスを保持しています。これは、インターフェースだけが知っている詳細を内省するために時々必要です。allow_empty_dataは、この文書の後半で説明する<code>read_data(data)</code>メソッドで使用されるフラグです。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=reset>reset<a href=#reset class=hash-link aria-label="reset への直接リンク" title="reset への直接リンク">​</a></h3>
<p>resetメソッドは、インターフェースが接続および/または切断されたときに内部プロトコル状態をリセットするために使用されます。このメソッドは共通のリセットロジックに使用されるべきです。接続と切断の特定のロジックは、次の2つのメソッドで処理されます。</p>
<p>基本クラスのRuby実装:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(130, 170, 255)">reset</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">end</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>基本クラスのPython実装:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">reset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">pass</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>ご覧のように、基本クラスのreset実装は何も行いません。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=connect_reset>connect_reset<a href=#connect_reset class=hash-link aria-label="connect_reset への直接リンク" title="connect_reset への直接リンク">​</a></h3>
<p>connect_resetメソッドは、インターフェースが接続されるたびに内部プロトコル状態をリセットするために使用されます。</p>
<p>基本クラスのRuby実装:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(130, 170, 255)">connect_reset</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  reset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">end</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>基本クラスのPython実装:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">connect_reset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">reset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>基本クラスのconnect_reset実装は、共通のリセットロジックが実行されることを確実にするために、単にresetメソッドを呼び出します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=disconnect_reset>disconnect_reset<a href=#disconnect_reset class=hash-link aria-label="disconnect_reset への直接リンク" title="disconnect_reset への直接リンク">​</a></h3>
<p>disconnect_resetメソッドは、インターフェースが切断されるたびに内部プロトコル状態をリセットするために使用されます。</p>
<p>基本クラスのRuby実装:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(130, 170, 255)">disconnect_reset</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  reset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">end</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>基本クラスのPython実装:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">disconnect_reset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">reset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>基本クラスのdisconnect_reset実装は、共通のリセットロジックが実行されることを確実にするために、単にresetメソッドを呼び出します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=read_data>read_data<a href=#read_data class=hash-link aria-label="read_data への直接リンク" title="read_data への直接リンク">​</a></h3>
<p>read_dataメソッドは、インターフェースによって読み取られた生データを分析し、潜在的に変更するために使用されます。分析されるデータの現在の状態として1つのパラメータを取ります。データの文字列、STOP、またはDISCONNECTのいずれかを返すことができます。文字列を返す場合、データが完全なパケットになる準備ができていて、後続のプロトコルによる処理の準備ができていると考えられます。STOPが返された場合、プロトコルは完全なパケットを完成させるためにさらにデータが必要だと考えています。DISCONNECTが返された場合、プロトコルはインターフェースを切断すべき（そして通常は自動的に再接続を試みる）と考えています。</p>
<p>基本クラスのRuby実装:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(130, 170, 255)">read_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">length </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> </span><span class="token variable" style="color:rgb(214, 222, 235)">@allow_empty_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token keyword" style="color:rgb(127, 219, 202)">nil</span><span class="token operator" style="color:rgb(127, 219, 202)">?</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">      </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> </span><span class="token variable" style="color:rgb(214, 222, 235)">@interface</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">and</span><span class="token plain"> </span><span class="token variable" style="color:rgb(214, 222, 235)">@interface</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">read_protocols</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">self</span><span class="token plain"> </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># 自動@allow_empty_dataを持つチェーン内の最後の読み取りインターフェース</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">        </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token symbol">:STOP</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">      </span><span class="token keyword" style="color:rgb(127, 219, 202)">end</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">elsif</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">!</span><span class="token variable" style="color:rgb(214, 222, 235)">@allow_empty_data</span><span class="token plain"> </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># @allow_empty_dataがfalseの場合はSTOP</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">      </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token symbol">:STOP</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">end</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">end</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  data</span><br></span><span class=token-line style=color:#d6deeb><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">end</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>基本クラスのPython実装:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">read_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> extra</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">        </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">allow_empty_data </span><span class="token keyword" style="color:rgb(127, 219, 202)">is</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">            </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">interface </span><span class="token keyword" style="color:rgb(127, 219, 202)">and</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">interface</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">read_protocols</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">                </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># 自動self.allow_empty_dataを持つチェーン内の最後の読み取りインターフェース</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">                </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">"STOP"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> extra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">        </span><span class="token keyword" style="color:rgb(127, 219, 202)">elif</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">allow_empty_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">            </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># self.allow_empty_dataがfalseの場合はSTOP</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">            </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">"STOP"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> extra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> extra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>基本クラスの実装は、与えられたデータを返すこと以外は何もしません。唯一の例外は空の文字列を処理する場合です。allow_empty_dataフラグがfalseである場合、またはnilであり、プロトコルがチェーン内の最後である場合、基本実装はSTOPを返し、インターフェースの<code>read_interface()</code>メソッドを呼び出してさらにデータを取得する時であることを示します。空の文字列は、キャッシュされたパケットを返す機会があることをプロトコルに通知するために使用されます。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=read_packet>read_packet<a href=#read_packet class=hash-link aria-label="read_packet への直接リンク" title="read_packet への直接リンク">​</a></h3>
<p>read_packetメソッドは、インターフェースによって返される前にCOSMOSパケットを分析し、潜在的に変更するために使用されます。分析されるパケットの現在の状態として1つのパラメータを取ります。COSMOSパケット、STOP、またはDISCONNECTのいずれかを返すことができます。COSMOSパケットを返す場合、パケットが有効であり、返されるべきであり、後続のプロトコルによる処理の準備ができていると考えられます。STOPが返された場合、プロトコルはパケットを静かに破棄すべきだと考えています。DISCONNECTが返された場合、プロトコルはインターフェースを切断すべき（そして通常は自動的に再接続を試みる）と考えています。このメソッドは、パケットがリアルタイムテレメトリではなく保存されたテレメトリであるとプロトコルが判断した場合に、パケットにstoredフラグを設定する場所です。</p>
<p>基本クラスのRuby実装:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(130, 170, 255)">read_packet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">packet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> packet</span><br></span><span class=token-line style=color:#d6deeb><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">end</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>基本クラスのPython実装:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">read_packet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> packet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> packet</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>基本クラスは常に与えられたパケットをそのまま返します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=write_packet>write_packet<a href=#write_packet class=hash-link aria-label="write_packet への直接リンク" title="write_packet への直接リンク">​</a></h3>
<p>write_packetメソッドは、インターフェースによって出力される前にCOSMOSパケットを分析し、潜在的に変更するために使用されます。分析されるパケットの現在の状態として1つのパラメータを取ります。COSMOSパケット、STOP、またはDISCONNECTのいずれかを返すことができます。COSMOSパケットを返す場合、パケットが有効であり、インターフェースに書き出されるべきであり、後続のプロトコルによる処理の準備ができていると考えられます。STOPが返された場合、プロトコルはパケットを静かに破棄すべきだと考えています。DISCONNECTが返された場合、プロトコルはインターフェースを切断すべき（そして通常は自動的に再接続を試みる）と考えています。</p>
<p>基本クラスのRuby実装:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(130, 170, 255)">write_packet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">packet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> packet</span><br></span><span class=token-line style=color:#d6deeb><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">end</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>基本クラスのPython実装:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">write_packet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> packet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> packet</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>基本クラスは常に与えられたパケットをそのまま返します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=write_data>write_data<a href=#write_data class=hash-link aria-label="write_data への直接リンク" title="write_data への直接リンク">​</a></h3>
<p>write_dataメソッドは、インターフェースによって書き込まれる前にデータを分析し、潜在的に変更するために使用されます。分析および送信されるデータの現在の状態として1つのパラメータを取ります。データの文字列、STOP、またはDISCONNECTのいずれかを返すことができます。データの文字列を返す場合、データが有効であり、インターフェースに書き出されるべきであり、後続のプロトコルによる処理の準備ができていると考えられます。STOPが返された場合、プロトコルはデータを静かに破棄すべきだと考えています。DISCONNECTが返された場合、プロトコルはインターフェースを切断すべき（そして通常は自動的に再接続を試みる）と考えています。</p>
<p>基本クラスのRuby実装:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(130, 170, 255)">write_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> data</span><br></span><span class=token-line style=color:#d6deeb><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">end</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>基本クラスのPython実装:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">write_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> extra</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> extra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>基本クラスは常に与えられたデータをそのまま返します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=post_write_interface>post_write_interface<a href=#post_write_interface class=hash-link aria-label="post_write_interface への直接リンク" title="post_write_interface への直接リンク">​</a></h3>
<p>post_write_interfaceメソッドは、データがインターフェースに書き込まれた後に呼び出されます。このメソッドの典型的な使用法は、コマンドに対して常に即時の応答が期待されるコマンド/レスポンスタイプのインターフェースを実装するためのフックを提供することです。<code>write_packet()</code>によるすべての変更後のパケットと、インターフェースに実際に書き込まれたデータという2つのパラメータを取ります。同じパケット/データのペア、STOP、またはDISCONNECTのいずれかを返すことができます。パケット/データのペアを返す場合、それらは他のプロトコルに渡されます。STOPが返された場合、インターフェースのwrite()呼び出しが完了し、それ以上のプロトコルの<code>post_write_interface()</code>メソッドは呼び出されません。DISCONNECTが返された場合、プロトコルはインターフェースを切断すべき（そして通常は自動的に再接続を試みる）と考えています。戻り値の最初のパラメータ「packet」だけがSTOPまたはDISCONNECTとしてチェックされることに注意してください。</p>
<p>基本クラスのRuby実装:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(130, 170, 255)">post_write_interface</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">packet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> packet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> data</span><br></span><span class=token-line style=color:#d6deeb><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">end</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>基本クラスのPython実装:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">post_write_interface</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> packet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> extra</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">packet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> extra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>基本クラスは常に与えられたパケット/データをそのまま返します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=protocol_cmd>protocol_cmd<a href=#protocol_cmd class=hash-link aria-label="protocol_cmd への直接リンク" title="protocol_cmd への直接リンク">​</a></h3>
<p>protocol_cmdメソッドは、プロトコル自体にコマンドを送信するために使用されます。これは実行時にプロトコルの動作を変更するのに役立ちます。詳細については<a href=/ja/docs/guides/scripting-api#interface_protocol_cmd>interface_protocol_cmd</a>を参照してください。</p>
<p>基本クラスのRuby実装:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(130, 170, 255)">protocol_cmd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">cmd_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">*</span><span class="token plain">cmd_args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># デフォルトでは何もしない - サブクラスによって実装される</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">end</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>基本クラスのPython実装:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#d6deeb;--prism-background-color:#011627><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#d6deeb;background-color:#011627><code class=codeBlockLines_e6Vv><span class=token-line style=color:#d6deeb><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">protocol_cmd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> cmd_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">*</span><span class="token plain">cmd_args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># デフォルトでは何もしない - サブクラスによって実装される</span><span class="token plain"></span><br></span><span class=token-line style=color:#d6deeb><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">False</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=クリップボードにコードをコピー title=コピー class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>これはサブクラスによって実装される特別な機能であるため、基本クラスは何も行いません。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=例>例<a href=#例 class=hash-link aria-label="例 への直接リンク" title="例 への直接リンク">​</a></h2>
<p>上記のメソッドの実際の例については、リンクされている<a href=https://github.com/OpenC3/cosmos/blob/main/openc3/lib/openc3/interfaces/protocols target=_blank rel="noopener noreferrer">Ruby Protocol</a>および<a href=https://github.com/OpenC3/cosmos/blob/main/openc3/python/openc3/interfaces/protocols target=_blank rel="noopener noreferrer">Python Protocol</a>コードを参照してください。</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/OpenC3/cosmos/tree/main/docs.openc3.com/docs/configuration/protocols.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>このページを編集</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label=ドキュメントページ><a class="pagination-nav__link pagination-nav__link--prev" href=/ja/docs/configuration/interfaces><div class=pagination-nav__sublabel>前へ</div><div class=pagination-nav__label>インターフェース</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/ja/docs/configuration/accessors><div class=pagination-nav__sublabel>次へ</div><div class=pagination-nav__label>アクセサー</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#パケット区切りプロトコル class="table-of-contents__link toc-highlight">パケット区切りプロトコル</a><ul><li><a href=#cobsプロトコル class="table-of-contents__link toc-highlight">COBSプロトコル</a><li><a href=#slipプロトコル class="table-of-contents__link toc-highlight">SLIPプロトコル</a><li><a href=#バーストプロトコル class="table-of-contents__link toc-highlight">バーストプロトコル</a><li><a href=#固定プロトコル class="table-of-contents__link toc-highlight">固定プロトコル</a><li><a href=#長さプロトコル class="table-of-contents__link toc-highlight">長さプロトコル</a><li><a href=#終端プロトコル class="table-of-contents__link toc-highlight">終端プロトコル</a><li><a href=#gemsプロトコルenterprise class="table-of-contents__link toc-highlight">GEMSプロトコル（Enterprise）</a><li><a href=#ccsds-cltuプロトコルenterprise class="table-of-contents__link toc-highlight">CCSDS CLTUプロトコル（Enterprise）</a><li><a href=#ccsds-tctfプロトコルenterprise class="table-of-contents__link toc-highlight">CCSDS TCTFプロトコル（Enterprise）</a><li><a href=#ccsds-tmtfプロトコルenterprise class="table-of-contents__link toc-highlight">CCSDS TMTFプロトコル（Enterprise）</a><li><a href=#テンプレートプロトコル非推奨 class="table-of-contents__link toc-highlight">テンプレートプロトコル（非推奨）</a><li><a href=#事前識別プロトコル内部 class="table-of-contents__link toc-highlight">事前識別プロトコル（内部）</a></ul><li><a href=#ヘルパープロトコル class="table-of-contents__link toc-highlight">ヘルパープロトコル</a><ul><li><a href=#cmdresponseプロトコル class="table-of-contents__link toc-highlight">CmdResponseプロトコル</a><ul><li><a href=#パケット定義 class="table-of-contents__link toc-highlight">パケット定義</a></ul><li><a href=#crcプロトコル class="table-of-contents__link toc-highlight">CRCプロトコル</a><li><a href=#パケット無視プロトコル class="table-of-contents__link toc-highlight">パケット無視プロトコル</a></ul><li><a href=#custom-protocol class="table-of-contents__link toc-highlight">カスタムプロトコル</a><li><a href=#メソッドの説明 class="table-of-contents__link toc-highlight">メソッドの説明</a><ul><li><a href=#initialize-または-init class="table-of-contents__link toc-highlight">initialize または <strong>init</strong></a><li><a href=#reset class="table-of-contents__link toc-highlight">reset</a><li><a href=#connect_reset class="table-of-contents__link toc-highlight">connect_reset</a><li><a href=#disconnect_reset class="table-of-contents__link toc-highlight">disconnect_reset</a><li><a href=#read_data class="table-of-contents__link toc-highlight">read_data</a><li><a href=#read_packet class="table-of-contents__link toc-highlight">read_packet</a><li><a href=#write_packet class="table-of-contents__link toc-highlight">write_packet</a><li><a href=#write_data class="table-of-contents__link toc-highlight">write_data</a><li><a href=#post_write_interface class="table-of-contents__link toc-highlight">post_write_interface</a><li><a href=#protocol_cmd class="table-of-contents__link toc-highlight">protocol_cmd</a></ul><li><a href=#例 class="table-of-contents__link toc-highlight">例</a></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class=footer__title>ホームページ</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://openc3.com target=_blank rel="noopener noreferrer" class=footer__link-item>ホーム</a></ul></div><div class="col footer__col"><div class=footer__title>ドキュメント</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/ja/docs>ドキュメント</a></ul></div><div class="col footer__col"><div class=footer__title>コミュニティ</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://www.linkedin.com/company/openc3 target=_blank rel="noopener noreferrer" class=footer__link-item>LinkedIn<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div><div class="col footer__col"><div class=footer__title>その他</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/OpenC3/cosmos target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a class=footer__link-item href=/ja/docs/privacy>プライバシーポリシー</a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2025 OpenC3, Inc.</div></div></div></footer></div>