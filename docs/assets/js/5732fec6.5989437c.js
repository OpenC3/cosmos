"use strict";(self.webpackChunkdocs_openc3_com=self.webpackChunkdocs_openc3_com||[]).push([["2149"],{7608:function(e,s,n){n.r(s),n.d(s,{metadata:()=>r,default:()=>h,frontMatter:()=>c,contentTitle:()=>d,toc:()=>l,assets:()=>o});var r=JSON.parse('{"id":"getting-started/security","title":"Security","description":"Security considerations and credential management for COSMOS deployments","source":"@site/docs/getting-started/security.md","sourceDirName":"getting-started","slug":"/getting-started/security","permalink":"/docs/getting-started/security","draft":false,"unlisted":false,"editUrl":"https://github.com/OpenC3/cosmos/tree/main/docs.openc3.com/docs/getting-started/security.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Security","description":"Security considerations and credential management for COSMOS deployments","sidebar_custom_props":{"myEmoji":"\u{1F512}"}},"sidebar":"defaultSidebar","previous":{"title":"Getting Started","permalink":"/docs/getting-started/gettingstarted"},"next":{"title":"Upgrading","permalink":"/docs/getting-started/upgrading"}}'),i=n(5656),t=n(5395);let c={sidebar_position:4,title:"Security",description:"Security considerations and credential management for COSMOS deployments",sidebar_custom_props:{myEmoji:"\u{1F512}"}},d,o={},l=[{value:"Overview",id:"overview",level:2},{value:"Security Boundaries",id:"security-boundaries",level:2},{value:"Docker Network",id:"docker-network",level:3},{value:"Host Computer",id:"host-computer",level:3},{value:"Local vs Network Configuration",id:"local-vs-network-configuration",level:3},{value:"Network Security",id:"network-security",level:3},{value:"Runtime Secrets in Docker",id:"runtime-secrets-in-docker",level:2},{value:"Credentials",id:"credentials",level:2},{value:"Redis Credentials",id:"redis-credentials",level:3},{value:"VersityGW (S3 Storage) Credentials",id:"versitygw-s3-storage-credentials",level:3},{value:"Service Authentication",id:"service-authentication",level:3},{value:"Rails Application Secret",id:"rails-application-secret",level:3},{value:"COSMOS Enterprise Credentials",id:"cosmos-enterprise-credentials",level:3},{value:"The users.acl File",id:"the-usersacl-file",level:2},{value:"ACL File Format",id:"acl-file-format",level:3},{value:"Default Users",id:"default-users",level:3},{value:"User Permissions",id:"user-permissions",level:3},{value:"Relationship Between .env and users.acl",id:"relationship-between-env-and-usersacl",level:3},{value:"Securing Your Deployment",id:"securing-your-deployment",level:2},{value:"Changing Redis Passwords",id:"changing-redis-passwords",level:3},{value:"Changing VersityGW Passwords",id:"changing-versitygw-passwords",level:3},{value:"Changing the Service Password",id:"changing-the-service-password",level:3},{value:"Generating a New SECRET_KEY_BASE",id:"generating-a-new-secret_key_base",level:3},{value:"Removing Cleartext Passwords from .env",id:"removing-cleartext-passwords-from-env",level:3},{value:"Security Recommendations",id:"security-recommendations",level:2},{value:"Frontend vs Backend Authentication",id:"frontend-vs-backend-authentication",level:2}];function a(e){let s={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.p,{children:"This document covers security considerations for COSMOS deployments, including credential management, security boundaries, and recommendations for production environments."}),"\n",(0,i.jsx)(s.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(s.p,{children:"COSMOS uses several backend service credentials that are separate from the frontend user account you create when first accessing the web interface. The backend passwords authenticate communication between COSMOS microservices, while the frontend password is for human users accessing COSMOS through a web browser. In COSMOS Enterprise, the frontend user accounts are managed by Keycloak."}),"\n",(0,i.jsxs)(s.p,{children:["When you first navigate to COSMOS Core and are prompted to create a password, you are creating a ",(0,i.jsx)(s.strong,{children:"frontend user password"})," that is separate from all the backend service passwords discussed below."]}),"\n",(0,i.jsx)(s.h2,{id:"security-boundaries",children:"Security Boundaries"}),"\n",(0,i.jsx)(s.p,{children:"Proper security is always a matter of trade-offs and layers. This section discusses the different security boundaries relevant to COSMOS."}),"\n",(0,i.jsx)(s.h3,{id:"docker-network",children:"Docker Network"}),"\n",(0,i.jsxs)(s.p,{children:["All COSMOS containers run in a Docker network called ",(0,i.jsx)(s.code,{children:"openc3-cosmos-network"}),". Only the Traefik load balancer is exposed directly to any outside network, with ports for HTTP and HTTPS traffic. If HTTPS is enabled, all HTTP traffic is redirected to HTTPS."]}),"\n",(0,i.jsx)(s.p,{children:"The load balancer routes specific paths to VersityGW or the COSMOS APIs, making them available to the outside network through the same hostname as the load balancer. In COSMOS Enterprise, Keycloak is also routed through the load balancer."}),"\n",(0,i.jsx)(s.p,{children:"Other COSMOS services such as Redis and all worker microservices have no direct exposure outside of the Docker network."}),"\n",(0,i.jsx)(s.h3,{id:"host-computer",children:"Host Computer"}),"\n",(0,i.jsx)(s.p,{children:"The host computer is the most critical layer to protect because it has control of the Docker infrastructure. A user with Docker access on the host computer can:"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:"Kill all containers"}),"\n",(0,i.jsx)(s.li,{children:"Access any container with root permission and view all files and data"}),"\n",(0,i.jsx)(s.li,{children:"See the environment variables for any process"}),"\n",(0,i.jsx)(s.li,{children:"Read all of the COSMOS configuration files"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"The host computer should ideally be dedicated to running COSMOS and have limited access by only trusted users."}),"\n",(0,i.jsx)(s.h3,{id:"local-vs-network-configuration",children:"Local vs Network Configuration"}),"\n",(0,i.jsx)(s.p,{children:"By default, COSMOS only listens on localhost (127.0.0.1). This configuration keeps COSMOS completely off the network and is only vulnerable to local users of the host computer."}),"\n",(0,i.jsxs)(s.p,{children:["For production use, it is recommended to configure COSMOS to listen on a network interface (not just localhost) so that users can access the web interface from their own workstations rather than directly on the host computer. This means users connect via their web browsers over the local network instead of needing access to the host machine itself, which reduces exposure of the host and allows it to be more tightly secured. See ",(0,i.jsx)(s.a,{href:"../configuration/ssl-tls",children:"SSL/TLS"})," for configuring HTTPS."]}),"\n",(0,i.jsx)(s.h3,{id:"network-security",children:"Network Security"}),"\n",(0,i.jsx)(s.p,{children:"Between any external network and the private network containing the host computer should be a firewall that prevents unauthorized access."}),"\n",(0,i.jsx)(s.p,{children:"Exposing COSMOS directly to the public internet is not recommended. While the system itself is secure, there is no built-in denial of service (DOS) protection, and an adversary could overwhelm the system with requests."}),"\n",(0,i.jsx)(s.h2,{id:"runtime-secrets-in-docker",children:"Runtime Secrets in Docker"}),"\n",(0,i.jsx)(s.p,{children:"There are two ways to pass runtime secrets into containers: environment variables and mounted files."}),"\n",(0,i.jsxs)(s.p,{children:["Environment variables passed to containers can be sourced from host environment variables or from a ",(0,i.jsx)(s.code,{children:".env"})," file. Files mounted into containers must exist as local files accessible by the user starting COSMOS."]}),"\n",(0,i.jsx)(s.p,{children:"In both cases, secrets need to be available to the user account starting COSMOS. This account must have sufficient trust to control container lifecycles and all data within the containers."}),"\n",(0,i.jsxs)(s.p,{children:["Most standard containers for databases like VersityGW are set up to receive secrets through environment variables. For a thorough discussion of secrets in Docker, see the ",(0,i.jsx)(s.a,{href:"https://github.com/moby/moby/issues/13490",children:"official thread"}),"."]}),"\n",(0,i.jsx)(s.h2,{id:"credentials",children:"Credentials"}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:".env"})," file contains environment variables that configure COSMOS. The password-related variables fall into several categories."]}),"\n",(0,i.jsx)(s.h3,{id:"redis-credentials",children:"Redis Credentials"}),"\n",(0,i.jsx)(s.p,{children:"Redis is the primary data store and pub/sub messaging system for COSMOS."}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Variable"}),(0,i.jsx)(s.th,{children:"Default Value"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"OPENC3_REDIS_USERNAME"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"openc3"})}),(0,i.jsx)(s.td,{children:"Username for the main COSMOS Redis connection"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"OPENC3_REDIS_PASSWORD"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"openc3password"})}),(0,i.jsx)(s.td,{children:"Password for the main COSMOS Redis connection"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"OPENC3_SR_REDIS_USERNAME"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"scriptrunner"})}),(0,i.jsx)(s.td,{children:"Username passed to spawned user scripts"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"OPENC3_SR_REDIS_PASSWORD"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"scriptrunnerpassword"})}),(0,i.jsx)(s.td,{children:"Password passed to spawned user scripts"})]})]})]}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"OPENC3_REDIS_*"})," credentials are used by COSMOS services (cmd-tlm-api, script-runner-api, operator, and init containers) to connect to Redis with full access to the COSMOS keyspace."]}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"OPENC3_SR_REDIS_*"})," credentials are passed to ",(0,i.jsx)(s.strong,{children:"spawned user scripts"})," when Script Runner executes them. The script-runner-api itself uses the main ",(0,i.jsx)(s.code,{children:"OPENC3_REDIS_*"})," credentials, but when it spawns a user script process, it substitutes the limited ",(0,i.jsx)(s.code,{children:"SR"})," credentials. This prevents user scripts from accessing or modifying data they shouldn't have access to."]}),"\n",(0,i.jsx)(s.h3,{id:"versitygw-s3-storage-credentials",children:"VersityGW (S3 Storage) Credentials"}),"\n",(0,i.jsx)(s.p,{children:"VersityGW provides S3-compatible object storage for logs, configurations, and other files."}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Variable"}),(0,i.jsx)(s.th,{children:"Default Value"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"OPENC3_BUCKET_USERNAME"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"openc3bucket"})}),(0,i.jsx)(s.td,{children:"Root username for VersityGW"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"OPENC3_BUCKET_PASSWORD"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"openc3bucketpassword"})}),(0,i.jsx)(s.td,{children:"Root password for VersityGW"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"OPENC3_SR_BUCKET_USERNAME"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"scriptrunnerbucket"})}),(0,i.jsx)(s.td,{children:"Username passed to spawned user scripts"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"OPENC3_SR_BUCKET_PASSWORD"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"scriptrunnerbucketpassword"})}),(0,i.jsx)(s.td,{children:"Password passed to spawned user scripts"})]})]})]}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"OPENC3_BUCKET_*"})," credentials are the VersityGW root credentials used by COSMOS services to manage buckets and files."]}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"OPENC3_SR_BUCKET_*"})," credentials create a separate VersityGW user with limited permissions. Similar to the Redis credentials, these are passed to ",(0,i.jsx)(s.strong,{children:"spawned user scripts"})," rather than being used by the script-runner-api itself, following the principle of least privilege."]}),"\n",(0,i.jsx)(s.h3,{id:"service-authentication",children:"Service Authentication"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Variable"}),(0,i.jsx)(s.th,{children:"Default Value"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsx)(s.tbody,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"OPENC3_SERVICE_PASSWORD"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"openc3service"})}),(0,i.jsx)(s.td,{children:"Service account password for internal API authentication"})]})})]}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"OPENC3_SERVICE_PASSWORD"})," is a backend service account password that allows internal COSMOS services to authenticate with the APIs without requiring a frontend user's credentials. It is used in the following contexts:"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"COSMOS Core:"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Script Runner"}),": When spawning user scripts, the script process uses this password to authenticate with the COSMOS APIs (cmd-tlm-api) to send commands, retrieve telemetry, etc."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Command Queues"}),": When executing queued commands, the queues controller uses this password for API authentication."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"COSMOS Enterprise (additional uses):"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Calendar (Timeline Microservice)"}),": When executing scheduled commands or scripts, uses this password for authentication."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Autonomic (Reaction Microservice)"}),": When executing reaction commands or scripts in response to triggers, uses this password for authentication."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Note: In COSMOS Enterprise with Keycloak, user offline access tokens can be used instead when available, but the service password serves as a fallback for automated operations."}),"\n",(0,i.jsx)(s.h3,{id:"rails-application-secret",children:"Rails Application Secret"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Variable"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsx)(s.tbody,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"SECRET_KEY_BASE"})}),(0,i.jsx)(s.td,{children:"A 128-character hexadecimal string used by Rails for encryption"})]})})]}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"SECRET_KEY_BASE"})," is used by the Rails applications (cmd-tlm-api and script-runner-api) for encrypting session data and other security-sensitive operations. This should be a unique, randomly-generated value for each COSMOS installation. The default value in the ",(0,i.jsx)(s.code,{children:".env"})," file should be changed for production deployments."]}),"\n",(0,i.jsx)(s.p,{children:"You can generate a new secret key with:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"openssl rand -hex 64\n"})}),"\n",(0,i.jsx)(s.h3,{id:"cosmos-enterprise-credentials",children:"COSMOS Enterprise Credentials"}),"\n",(0,i.jsxs)(s.p,{children:["COSMOS Enterprise has additional credentials for Keycloak and PostgreSQL. See the ",(0,i.jsx)(s.code,{children:"DockerComposeSecurity.md"})," file in your project directory for Enterprise-specific credential documentation."]}),"\n",(0,i.jsx)(s.h2,{id:"the-usersacl-file",children:"The users.acl File"}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"users.acl"})," file (located at ",(0,i.jsx)(s.code,{children:"openc3-redis/users.acl"}),") configures Redis authentication and authorization. This file is ",(0,i.jsx)(s.strong,{children:"only for Redis"})," and has no relation to VersityGW or other services."]}),"\n",(0,i.jsx)(s.h3,{id:"acl-file-format",children:"ACL File Format"}),"\n",(0,i.jsx)(s.p,{children:"Each line defines a user with the syntax:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"user <username> [on/off] <password> [keyspace] [commands]\n"})}),"\n",(0,i.jsx)(s.p,{children:"Passwords can be specified as:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["SHA-256 hash: prefix with ",(0,i.jsx)(s.code,{children:"#"})," (e.g., ",(0,i.jsx)(s.code,{children:"#022bd57..."}),")"]}),"\n",(0,i.jsxs)(s.li,{children:["Plaintext: prefix with ",(0,i.jsx)(s.code,{children:">"})," (e.g., ",(0,i.jsx)(s.code,{children:">openc3password"}),")"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Using hashed passwords is recommended for production to avoid storing cleartext passwords on disk."}),"\n",(0,i.jsx)(s.h3,{id:"default-users",children:"Default Users"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"User"}),(0,i.jsx)(s.th,{children:"Default Password"}),(0,i.jsx)(s.th,{children:"Purpose"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"openc3"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"openc3password"})}),(0,i.jsx)(s.td,{children:"Main COSMOS service account with full keyspace access"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"scriptrunner"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"scriptrunnerpassword"})}),(0,i.jsx)(s.td,{children:"Limited access for Script Runner"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"admin"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"admin"})}),(0,i.jsx)(s.td,{children:"Optional admin account for Redis management"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"healthcheck"})}),(0,i.jsx)(s.td,{children:"(no password)"}),(0,i.jsx)(s.td,{children:"Health check user with minimal permissions"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"default"})}),(0,i.jsx)(s.td,{children:"(disabled)"}),(0,i.jsx)(s.td,{children:"Default Redis user, disabled for security"})]})]})]}),"\n",(0,i.jsx)(s.h3,{id:"user-permissions",children:"User Permissions"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"openc3"}),": Has access to the entire COSMOS keyspace but cannot reconfigure Redis itself. This is the main service account used by COSMOS."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"scriptrunner"}),": Has restricted access to only:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Keys matching ",(0,i.jsx)(s.code,{children:"running-script*"}),", ",(0,i.jsx)(s.code,{children:"*script-locks"}),", ",(0,i.jsx)(s.code,{children:"*script-breakpoints"}),", ",(0,i.jsx)(s.code,{children:"*openc3_log_messages"})]}),"\n",(0,i.jsxs)(s.li,{children:["Channels for ",(0,i.jsx)(s.code,{children:"_action_cable_internal"}),", ",(0,i.jsx)(s.code,{children:"script-api:*"})]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"This prevents user scripts from accessing or destroying other COSMOS data."}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"admin"}),": Has ",(0,i.jsx)(s.code,{children:"@admin"})," permissions which includes the ",(0,i.jsx)(s.code,{children:"ACL"})," command. This user is optional and can be disabled by changing ",(0,i.jsx)(s.code,{children:"on"})," to ",(0,i.jsx)(s.code,{children:"off"})," or removing the line entirely."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"healthcheck"}),": Used during container startup to verify Redis is available. Has no password and can only run ",(0,i.jsx)(s.code,{children:"cluster info"})," and ",(0,i.jsx)(s.code,{children:"ping"})," commands."]}),"\n",(0,i.jsx)(s.h3,{id:"relationship-between-env-and-usersacl",children:"Relationship Between .env and users.acl"}),"\n",(0,i.jsxs)(s.p,{children:["The passwords in ",(0,i.jsx)(s.code,{children:".env"})," must match the passwords in ",(0,i.jsx)(s.code,{children:"users.acl"}),":"]}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:".env Variable"}),(0,i.jsx)(s.th,{children:"users.acl User"}),(0,i.jsx)(s.th,{children:"Must Match"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"OPENC3_REDIS_PASSWORD"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"openc3"})}),(0,i.jsx)(s.td,{children:"Yes - COSMOS services use these credentials to connect to Redis"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"OPENC3_SR_REDIS_PASSWORD"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"scriptrunner"})}),(0,i.jsx)(s.td,{children:"Yes - Spawned user scripts use these credentials"})]})]})]}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"admin"})," user in ",(0,i.jsx)(s.code,{children:"users.acl"})," does not have a corresponding ",(0,i.jsx)(s.code,{children:".env"})," variable since it's only used for manual Redis administration."]}),"\n",(0,i.jsxs)(s.p,{children:["The VersityGW credentials (",(0,i.jsx)(s.code,{children:"OPENC3_BUCKET_*"}),", ",(0,i.jsx)(s.code,{children:"OPENC3_SR_BUCKET_*"}),") and ",(0,i.jsx)(s.code,{children:"OPENC3_SERVICE_PASSWORD"})," have no corresponding entries in ",(0,i.jsx)(s.code,{children:"users.acl"})," since they are for different services."]}),"\n",(0,i.jsx)(s.h2,{id:"securing-your-deployment",children:"Securing Your Deployment"}),"\n",(0,i.jsx)(s.h3,{id:"changing-redis-passwords",children:"Changing Redis Passwords"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Generate a SHA-256 hash of your new password:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"./openc3.sh util hash yournewpassword\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Update ",(0,i.jsx)(s.code,{children:"openc3-redis/users.acl"})," with the new hash:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"user openc3 on #newhashvalue allkeys allchannels ...\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Update ",(0,i.jsx)(s.code,{children:".env"})," with the new cleartext password:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"OPENC3_REDIS_PASSWORD=yournewpassword\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Repeat for the ",(0,i.jsx)(s.code,{children:"scriptrunner"})," user if desired."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"changing-versitygw-passwords",children:"Changing VersityGW Passwords"}),"\n",(0,i.jsxs)(s.p,{children:["Update the values in ",(0,i.jsx)(s.code,{children:".env"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"OPENC3_BUCKET_PASSWORD=yournewpassword\nOPENC3_SR_BUCKET_PASSWORD=yournewsrpassword\n"})}),"\n",(0,i.jsx)(s.h3,{id:"changing-the-service-password",children:"Changing the Service Password"}),"\n",(0,i.jsxs)(s.p,{children:["Update the value in ",(0,i.jsx)(s.code,{children:".env"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"OPENC3_SERVICE_PASSWORD=yournewservicepassword\n"})}),"\n",(0,i.jsx)(s.h3,{id:"generating-a-new-secret_key_base",children:"Generating a New SECRET_KEY_BASE"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"openssl rand -hex 64\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Then update ",(0,i.jsx)(s.code,{children:".env"})," with the new value."]}),"\n",(0,i.jsx)(s.h3,{id:"removing-cleartext-passwords-from-env",children:"Removing Cleartext Passwords from .env"}),"\n",(0,i.jsxs)(s.p,{children:["For enhanced security, you can remove passwords from the ",(0,i.jsx)(s.code,{children:".env"})," file entirely and pass them as environment variables at runtime:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"OPENC3_REDIS_PASSWORD=mypassword OPENC3_BUCKET_PASSWORD=mypassword ./openc3.sh run\n"})}),"\n",(0,i.jsx)(s.p,{children:"This prevents cleartext passwords from being stored on disk, though you must provide them each time you start COSMOS."}),"\n",(0,i.jsx)(s.h2,{id:"security-recommendations",children:"Security Recommendations"}),"\n",(0,i.jsx)(s.p,{children:"For production deployments:"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Change all default passwords"})," before deploying COSMOS."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Use hashed passwords"})," in ",(0,i.jsx)(s.code,{children:"users.acl"})," to avoid storing cleartext passwords on disk."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Restrict file permissions"})," on ",(0,i.jsx)(s.code,{children:".env"})," and ",(0,i.jsx)(s.code,{children:"users.acl"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"chmod 600 .env\nchmod 600 openc3-redis/users.acl\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Configure SSL/TLS"})," before exposing COSMOS to any network. See ",(0,i.jsx)(s.a,{href:"../configuration/ssl-tls",children:"SSL/TLS Configuration"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Disable or secure the Redis admin user"})," if not needed:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"user admin off #hashvalue +@admin\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Generate a unique SECRET_KEY_BASE"})," for each installation."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Limit host computer access"})," to only trusted administrators."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Use a firewall"})," to restrict network access to COSMOS."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"frontend-vs-backend-authentication",children:"Frontend vs Backend Authentication"}),"\n",(0,i.jsx)(s.p,{children:"It's important to understand the distinction:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Backend credentials"})," (this document): Service-to-service authentication between COSMOS containers. Users never enter these passwords directly."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Frontend credentials"}),": User accounts for accessing COSMOS through a web browser."]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"COSMOS Core"}),": Uses password-based authentication. The first user who connects sets the password that all users share."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"COSMOS Enterprise"}),": Uses Keycloak for authentication with individual user accounts, roles, and permissions."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["The frontend password you set when first accessing COSMOS at ",(0,i.jsx)(s.code,{children:"http://localhost:2900"})," is stored in Redis and is completely separate from the backend service credentials documented here."]})]})}function h(e={}){let{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},5395:function(e,s,n){n.d(s,{R:()=>c,x:()=>d});var r=n(7140);let i={},t=r.createContext(i);function c(e){let s=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(t.Provider,{value:s},e.children)}}}]);