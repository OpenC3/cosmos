COMMAND <%= target_name %> COLLECT BIG_ENDIAN "Starts a collect on the <%= target_name %> target"
  VALIDATOR inst_cmd_validator.rb
  <%= render "_ccsds_cmd.txt", locals: {id: 1} %>
  PARAMETER    TYPE           64  16  UINT MIN MAX 0 "Collect type which can be normal or special. Note the special collects are hazarous and require user confirmation."
    REQUIRED
    STATE NORMAL  0x0
    STATE SPECIAL 0x1 HAZARDOUS
  PARAMETER    DURATION       80  32  FLOAT 0.0 10.0 1.0 "Collect duration"
  PARAMETER    OPCODE        112   8  UINT 0x0 0xFF 0xAB "Collect opcode"
    FORMAT_STRING "0x%0X"
  PARAMETER    TEMP          120  32  FLOAT 0.0 25.0 0.0 "Collect temperature"
    UNITS Celsius C
  RELATED_ITEM <%= target_name %> HEALTH_STATUS COLLECTS
  RELATED_ITEM <%= target_name %> HEALTH_STATUS DURATION
  RELATED_ITEM <%= target_name %> HEALTH_STATUS COLLECT_TYPE

COMMAND <%= target_name %> ABORT BIG_ENDIAN "Aborts a collect on the <%= target_name %> instrument"
  VALIDATOR inst_cmd_validator.rb
  <%= render "_ccsds_cmd.txt", locals: {id: 2} %>

COMMAND <%= target_name %> CLEAR BIG_ENDIAN "Clears counters on the <%= target_name %> instrument"
  VALIDATOR inst_cmd_validator.rb
  HAZARDOUS "Clearing counters may lose valuable information."
  <%= render "_ccsds_cmd.txt", locals: {id: 3} %>
  RELATED_ITEM <%= target_name %> HEALTH_STATUS COLLECTS

COMMAND <%= target_name %> SETPARAMS BIG_ENDIAN "Sets numbered parameters"
  VALIDATOR inst_cmd_validator.rb
  <%= render "_ccsds_cmd.txt", locals: {id: 4} %>
  # ERB syntax:
  <% (1..5).each do |i| %>
    # The packet is BIG_ENDIAN (CCSDS) but these fields are LITTLE_ENDIAN
    APPEND_PARAMETER VALUE<%= i %> 16 UINT 0 5 1 "Value <%= i %> setting" LITTLE_ENDIAN
    RELATED_ITEM <%= target_name %> PARAMS VALUE<%= i %>
  <% end %>
  APPEND_PARAMETER BIGINT 64 UINT MIN MAX 0 "UINT 64 parameter"
  SCREEN <%= target_name %> PARAMS

  SELECT_PARAMETER VALUE5
    POLY_WRITE_CONVERSION 0 2

COMMAND <%= target_name %> ASCIICMD BIG_ENDIAN "Enumerated ASCII command"
  VALIDATOR inst_cmd_validator.rb
  <%= render "_ccsds_cmd.txt", locals: {id: 5} %>
  APPEND_PARAMETER STRING 2048 STRING "NOOP" "Enumerated string parameter"
    STATE "ARM LASER" "ARM LASER" HAZARDOUS "Arming the laser poses an eye safety hazard."
    STATE "FIRE LASER" "FIRE LASER" HAZARDOUS "WARNING Laser will be fired!"
    STATE "NOOP" "NOOP" DISABLE_MESSAGES
  APPEND_PARAMETER BINARY 32 BLOCK 0xDEADBEEF "Binary string"
  APPEND_PARAMETER ASCII 80 STRING "0xDEADBEEF" "ASCII string"
  RELATED_ITEM <%= target_name %> HEALTH_STATUS ASCIICMD

COMMAND <%= target_name %> FLTCMD BIG_ENDIAN "Command with float parameters"
  VALIDATOR inst_cmd_validator.rb
  <%= render "_ccsds_cmd.txt", locals: {id: 6} %>
  PARAMETER    FLOAT32        64  32  FLOAT MIN MAX 0.0 "Float32 parameter"
  PARAMETER    FLOAT64        96  64  FLOAT MIN MAX 0.0 "Float64 parameter"

COMMAND <%= target_name %> ARYCMD BIG_ENDIAN "Command with array parameter"
  VALIDATOR inst_cmd_validator.rb
  <%= render "_ccsds_cmd.txt", locals: {id: 7} %>
  ARRAY_PARAMETER ARRAY       64  32  UINT -8 "Array parameter"
  PARAMETER    CRC            -8   8  UINT MIN MAX 0 "CRC"

COMMAND <%= target_name %> SLRPNLDEPLOY BIG_ENDIAN "Deploy solar array panels"
  RESTRICTED
  VALIDATOR inst_cmd_validator.rb
  <%= render "_ccsds_cmd.txt", locals: {id: 8} %>
  RELATED_ITEM <%= target_name %> MECH SLRPNL1
  RELATED_ITEM <%= target_name %> MECH SLRPNL2
  RELATED_ITEM <%= target_name %> MECH SLRPNL3
  RELATED_ITEM <%= target_name %> MECH SLRPNL4
  RELATED_ITEM <%= target_name %> MECH SLRPNL5

COMMAND <%= target_name %> SLRPNLRESET BIG_ENDIAN "Reset solar array panels"
  RESTRICTED
  VALIDATOR inst_cmd_validator.rb
  <%= render "_ccsds_cmd.txt", locals: {id: 9} %>
  RELATED_ITEM <%= target_name %> MECH SLRPNL1
  RELATED_ITEM <%= target_name %> MECH SLRPNL2
  RELATED_ITEM <%= target_name %> MECH SLRPNL3
  RELATED_ITEM <%= target_name %> MECH SLRPNL4
  RELATED_ITEM <%= target_name %> MECH SLRPNL5

COMMAND <%= target_name %> MEMLOAD BIG_ENDIAN "Load memory"
  VALIDATOR inst_cmd_validator.rb
  DISABLE_MESSAGES # Disable messages on a command that could be sent many many times
  <%= render "_ccsds_cmd.txt", locals: {id: 10} %>
  APPEND_PARAMETER DATA 80 BLOCK "" "Block of data"
  RELATED_ITEM <%= target_name %> HEALTH_STATUS BLOCKTEST

COMMAND <%= target_name %> QUIET BIG_ENDIAN "Enable/disable no out of limits in the demo"
  VALIDATOR inst_cmd_validator.rb
  <%= render "_ccsds_cmd.txt", locals: {id: 11} %>
  APPEND_PARAMETER STATE 8 UINT 0 1 1
    STATE FALSE 0
    STATE TRUE 1

COMMAND <%= target_name %> TIME_OFFSET BIG_ENDIAN "Subtract the packet time by the given seconds"
  VALIDATOR inst_cmd_validator.rb
  <%= render "_ccsds_cmd.txt", locals: {id: 12} %>
  APPEND_PARAMETER SECONDS 32 UINT MIN MAX 0 "Seconds to subtract from packet time"
  APPEND_PARAMETER IP_ADDRESS 32 UINT MIN MAX "127.0.0.1" "IP address"
    WRITE_CONVERSION ip_write_conversion.rb

COMMAND <%= target_name %> HIDDEN BIG_ENDIAN "Hidden command to bump the hidden packet"
  VALIDATOR inst_cmd_validator.rb
  HIDDEN
  <%= render "_ccsds_cmd.txt", locals: {id: 13} %>
  APPEND_PARAMETER COUNT 32 UINT MIN MAX 0 "Count to set"

COMMAND <%= target_name %> SET_PASSWORD BIG_ENDIAN "Set Password Command"
  APPEND_PARAMETER USERNAME  256 STRING "username"
  APPEND_PARAMETER PASSWORD_STR  256 STRING "password string"
    OBFUSCATE
  APPEND_PARAMETER SPACER_1  256 STRING "Spacer 1"
  APPEND_PARAMETER PASSWORD_UINT  8 UINT 0 10 0 "password uint"
    OBFUSCATE
  APPEND_PARAMETER SPACER_2  256 STRING "Spacer 2"
  APPEND_PARAMETER PASSWORD_BIG_UINT 32 UINT 0 10 0 "password big uint"
    OBFUSCATE
  APPEND_PARAMETER SPACER_3  256 STRING "Spacer 3"
  APPEND_PARAMETER PASSWORD_INT  8 INT 0 10 0 "password int"
    OBFUSCATE
  APPEND_PARAMETER SPACER_4  256 STRING "Spacer 4"
  APPEND_PARAMETER PASSWORD_FLOAT  32 FLOAT 0 10 0 "password float"
    OBFUSCATE
  APPEND_PARAMETER SPACER_5  256 STRING "Spacer 5"
  APPEND_PARAMETER PASSWORD_BLOCK  256 BLOCK "password block"
    OBFUSCATE
  APPEND_PARAMETER SPACER_6  256 STRING "Spacer 6"
  APPEND_ARRAY_PARAMETER ARRAY 64 FLOAT 640 "Array of 10 64bit floats"
    OBFUSCATE
  APPEND_PARAMETER SPACER_7  256 STRING "Spacer 7"

COMMAND <%= target_name %> JSONCMD BIG_ENDIAN "JSON Accessor Command"
  ACCESSOR JsonAccessor
  TEMPLATE '{"id_item":1, "item1":101, "more": { "item2":12, "item3":3.14, "item4":"Example", "item5":[4, 3, 2, 1] }, "item6": true, "item7": [1, "2", 3.14], "item8": {"a":"b"}, "item9": {"c":"d"} }'
  APPEND_ID_PARAMETER ID_ITEM 32 INT 31 31 31 "Int Item"
    KEY $.id_item
  APPEND_PARAMETER ITEM1 16 UINT MIN MAX 101 "Int Item 2"
    KEY $.item1
    UNITS CELSIUS C
  APPEND_PARAMETER ITEM2 16 UINT MIN MAX 12 "Int Item 3"
    KEY $.more.item2
    FORMAT_STRING "0x%X"
  APPEND_PARAMETER ITEM3 64 FLOAT MIN MAX 3.14 "Float Item"
    KEY $.more.item3
  APPEND_PARAMETER ITEM4 128 STRING "Example" "String Item"
    KEY $.more.item4
  APPEND_ARRAY_PARAMETER ITEM5 8 UINT 0 "Array Item"
    KEY $.more.item5
  APPEND_PARAMETER ITEM6 8 BOOL true "Bool Item"
    KEY $.item6
  APPEND_PARAMETER ITEM7 8 ARRAY '[1,"2",3.14]' "Complex Array Item"
    KEY $.item7
  APPEND_PARAMETER ITEM8 8 OBJECT '{"a":"b"}' "Object Item"
    KEY $.item8
  APPEND_PARAMETER ITEM9 8 ANY '{"c":"d"}' "Any Item"
    KEY $.item9

COMMAND <%= target_name %> CBORCMD BIG_ENDIAN "CBOR Accessor Command"
  ACCESSOR CborAccessor
  TEMPLATE_FILE _cbor_template.bin
  APPEND_ID_PARAMETER ID_ITEM 32 INT 32 32 32 "Int Item"
    KEY $.id_item
  APPEND_PARAMETER ITEM1 16 UINT MIN MAX 101 "Int Item 2"
    KEY $.item1
    UNITS CELSIUS C
  APPEND_PARAMETER ITEM2 16 UINT MIN MAX 12 "Int Item 3"
    KEY $.more.item2
    FORMAT_STRING "0x%X"
  APPEND_PARAMETER ITEM3 64 FLOAT MIN MAX 3.14 "Float Item"
    KEY $.more.item3
  APPEND_PARAMETER ITEM4 128 STRING "Example" "String Item"
    KEY $.more.item4
  APPEND_ARRAY_PARAMETER ITEM5 8 UINT 0 "Array Item"
    KEY $.more.item5

COMMAND <%= target_name %> XMLCMD BIG_ENDIAN "XML Accessor Command"
  ACCESSOR XmlAccessor
  TEMPLATE '<html><head><script src="3"></script><noscript>101</noscript></head><body><img src="12"/><div><ul><li>3.14</li><li>Example</li></ul></div><div></div></body></html>'
  APPEND_ID_PARAMETER ID_ITEM 32 INT 33 33 33 "Int Item"
    KEY "/html/head/script/@src"
  APPEND_PARAMETER ITEM1 16 UINT MIN MAX 101 "Int Item 2"
    KEY "/html/head/noscript/text()"
    UNITS CELSIUS C
  APPEND_PARAMETER ITEM2 16 UINT MIN MAX 12 "Int Item 3"
    KEY "/html/body/img/@src"
    FORMAT_STRING "0x%X"
  APPEND_PARAMETER ITEM3 64 FLOAT MIN MAX 3.14 "Float Item"
    KEY "/html/body/div/ul/li[1]/text()"
  APPEND_PARAMETER ITEM4 128 STRING "Example" "String Item"
    KEY "/html/body/div/ul/li[2]/text()"

COMMAND <%= target_name %> HTMLCMD BIG_ENDIAN "HTML Accessor Command"
  ACCESSOR HtmlAccessor
  TEMPLATE '<!DOCTYPE html><html lang="en"><head><title>4</title><script src="101"></script></head><body><noscript>12</noscript><img src="3.14" alt="An Image"/><p>Example</p><ul><li>1</li><li>3.14</li></ul></body></html>'
  APPEND_ID_PARAMETER ID_ITEM 32 INT 34 34 34 "Int Item"
    KEY "/html/head/title/text()"
  APPEND_PARAMETER ITEM1 16 UINT MIN MAX 101 "Int Item 2"
    KEY "/html/head/script/@src"
    UNITS CELSIUS C
  APPEND_PARAMETER ITEM2 16 UINT MIN MAX 12 "Int Item 3"
    KEY "/html/body/noscript/text()"
    FORMAT_STRING "0x%X"
  APPEND_PARAMETER ITEM3 64 FLOAT MIN MAX 3.14 "Float Item"
    KEY "/html/body/img/@src"
  APPEND_PARAMETER ITEM4 128 STRING "Example" "String Item"
    KEY "/html/body/p/text()"

COMMAND <%= target_name %> JSONSTRUCT BIG_ENDIAN "JSON Structure"
  VIRTUAL
  ACCESSOR JsonAccessor
  TEMPLATE '{"id_item":1, "item1":101, "more": { "item2":12, "item3":3.14, "item4":"Example", "item5":[4, 3, 2, 1] } }'
  APPEND_PARAMETER ITEM0 32 INT 1 1 1 "Int Item"
    KEY $.id_item
  APPEND_PARAMETER ITEM1 16 UINT MIN MAX 101 "Int Item 2"
    KEY $.item1
    UNITS CELSIUS C
  APPEND_PARAMETER ITEM2 16 UINT MIN MAX 12 "Int Item 3"
    KEY $.more.item2
    FORMAT_STRING "0x%X"
  APPEND_PARAMETER ITEM3 64 FLOAT MIN MAX 3.14 "Float Item"
    KEY $.more.item3
  APPEND_PARAMETER ITEM4 128 STRING "Example" "String Item"
    KEY $.more.item4
  APPEND_ARRAY_PARAMETER ITEM5 8 UINT 0 "Array Item"
    KEY $.more.item5

COMMAND <%= target_name %> CBORSTRUCT BIG_ENDIAN "CBOR Structure"
  VIRTUAL
  ACCESSOR CborAccessor
  TEMPLATE_FILE _cbor_template.bin
  APPEND_PARAMETER ITEM0 32 INT 2 2 2 "Int Item"
    KEY $.id_item
  APPEND_PARAMETER ITEM1 16 UINT MIN MAX 101 "Int Item 2"
    KEY $.item1
    UNITS CELSIUS C
  APPEND_PARAMETER ITEM2 16 UINT MIN MAX 12 "Int Item 3"
    KEY $.more.item2
    FORMAT_STRING "0x%X"
  APPEND_PARAMETER ITEM3 64 FLOAT MIN MAX 3.14 "Float Item"
    KEY $.more.item3
  APPEND_PARAMETER ITEM4 128 STRING "Example" "String Item"
    KEY $.more.item4
  APPEND_ARRAY_PARAMETER ITEM5 8 UINT 0 "Array Item"
    KEY $.more.item5

COMMAND <%= target_name %> HYBRIDCMD BIG_ENDIAN "Hybrid Accessor Command"
  <%= render "_ccsds_cmd.txt", locals: {id: 14} %>
  APPEND_PARAMETER JSON_LENGTH 32 UINT MIN MAX 0
    HIDDEN
  APPEND_STRUCTURE JSON 0 CMD <%= target_name %> JSONSTRUCT
    VARIABLE_BIT_SIZE JSON_LENGTH
  APPEND_PARAMETER CBOR_LENGTH 32 UINT MIN MAX 0
    HIDDEN
  APPEND_STRUCTURE CBOR 0 CMD <%= target_name %> CBORSTRUCT
    VARIABLE_BIT_SIZE CBOR_LENGTH

# Throughput Testing Commands (for use with external throughput server)
COMMAND <%= target_name %> START_STREAM BIG_ENDIAN "Start telemetry streaming from throughput server"
  <%= render "_ccsds_cmd.txt", locals: {id: 200} %>
  APPEND_PARAMETER RATE 32 UINT 1 100000 100 "Packets per second"
  APPEND_PARAMETER PACKET_TYPES 32 UINT 0 0xFFFFFFFF 0x01 "Bitmask of packet types to stream"
  RELATED_ITEM <%= target_name %> THROUGHPUT_STATUS TLM_TARGET_RATE

COMMAND <%= target_name %> STOP_STREAM BIG_ENDIAN "Stop telemetry streaming from throughput server"
  <%= render "_ccsds_cmd.txt", locals: {id: 201} %>

COMMAND <%= target_name %> GET_STATS BIG_ENDIAN "Request throughput statistics from server"
  <%= render "_ccsds_cmd.txt", locals: {id: 202} %>

COMMAND <%= target_name %> GET_STATS_NO_MSG BIG_ENDIAN "Request throughput statistics from server"
  <%= render "_ccsds_cmd.txt", locals: {id: 203} %>
  DISABLE_MESSAGES

COMMAND <%= target_name %> RESET_STATS BIG_ENDIAN "Reset throughput statistics on server"
  <%= render "_ccsds_cmd.txt", locals: {id: 204} %>
